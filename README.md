![image](https://github.com/user-attachments/assets/b1413c0f-6219-4e3f-88aa-6ab8005b767d)

## ğŸš€ ì„œë¹„ìŠ¤ ì†Œê°œ

### âœ¨Â ì„œë¹„ìŠ¤ ê°œìš”

<aside>

ìš”ì¦˜ ë‹¤ì‹œ ì•¼êµ¬ ì—´ê¸°ê°€ ëœ¨ê±°ì›Œì¡ŒìŠµë‹ˆë‹¤.

í•˜ì§€ë§Œ ì•„ì§ ê¹Œì§€ í”„ë¡œì•¼êµ¬ í‹°ì¼“ ì˜ˆë§¤ëŠ” **í‹°ì¼“ ë§í¬, ì¸í„°íŒŒí¬ ë“± ì‚¬ì´íŠ¸ ë³„ë¡œ ë¶„ì‚°** ë˜ì–´ ìˆì–´

íŒ¬ ì…ì¥ì—ì„œ **ì˜ˆë§¤ í™˜ê²½ì´ ë¶ˆí¸í•˜ê³  ë²ˆê±°ë¡­ë‹¤ëŠ” ë¶ˆë§Œ**ì´ ë§ìŠµë‹ˆë‹¤.

ë˜í•œ, ê²½ê¸° ë‹¹ì¼ ê°‘ì‘ìŠ¤ëŸ¬ìš´ ì¼ì • ë³€ê²½ì´ë‚˜ ì˜ˆê¸°ì¹˜ ëª»í•œ ì‚¬ì •ìœ¼ë¡œ ì¸í•´

í‹°ì¼“ì„ ì‚¬ìš©í•˜ì§€ ëª»í•˜ê²Œ ë˜ëŠ” ê²½ìš°, **ì·¨ì†Œ ìˆ˜ìˆ˜ë£Œê°€ ë¶€ë‹´**ë˜ê³ ,

ë°˜ëŒ€ë¡œ ì¸ê¸° ê²½ê¸°ì˜ ê²½ìš° **ì›ƒëˆì„ ì£¼ê³ ì„œë¼ë„ í‹°ì¼“ì„ êµ¬í•˜ê³  ì‹¶ì€ íŒ¬ë“¤**ë„ ë§ìŠµë‹ˆë‹¤.

> ì´ëŸ¬í•œ ë‹ˆì¦ˆë¥¼ ë°”íƒ•ìœ¼ë¡œ
> 
> 
> "**í‹°ì¼“ ì˜ˆë§¤ì™€ í‹°ì¼“ ê²½ë§¤ê°€ í•¨ê»˜ ê°€ëŠ¥í•œ í†µí•© í”„ë¡œì•¼êµ¬ í‹°ì¼“ í”Œë«í¼**"ì„ ê¸°íší–ˆìŠµë‹ˆë‹¤.
>

</aside>

---

## ğŸ”‘ í•µì‹¬ ê¸°ëŠ¥

<details>
<summary><strong>ğŸ« í‹°ì¼“íŒ… ê¸°ëŠ¥</strong></summary>

- **ë‚¨ì€ ì¢Œì„ ìˆ˜ ì¡°íšŒ**

- **ì¢Œì„ ì ìœ  ë° í‹°ì¼“ ì˜ˆë§¤**

  <details>
  <summary><strong>ëŒ€ê¸°ì—´</strong></summary>

  ### 1. **ë„ì… ë°°ê²½ ë° ë¬¸ì œ ì¸ì‹**

  - í‹°ì¼“íŒ… ì‹œìŠ¤í…œì€ **ë‹¨ì‹œê°„ ë‚´ì— ìˆ˜ë§Œ ê±´ì˜ ìš”ì²­ì´ ì§‘ì¤‘ë˜ëŠ” ê³ ë¶€í•˜ ìƒí™©**ì´ ìì£¼ ë°œìƒí•©ë‹ˆë‹¤.
  - íŠ¹íˆ ì¸ê¸° ê²½ê¸°ë‚˜ ì´ë²¤íŠ¸ì˜ ì˜ˆë§¤ ì˜¤í”ˆ ì‹œì ì—ëŠ” ìˆ˜ì²œ ~ ìˆ˜ë§Œ ëª…ì˜ ì‚¬ìš©ìê°€ **ë™ì‹œ ì ‘ê·¼**í•©ë‹ˆë‹¤.
  - ê¸°ì¡´ ì‹œìŠ¤í…œì€ ì•„ë˜ì™€ ê°™ì€ ë¬¸ì œë¥¼ ì¼ìœ¼í‚¬ ê°€ëŠ¥ì„±ì´ ì»¸ìŠµë‹ˆë‹¤:
    - âŒ **DB ì»¤ë„¥ì…˜ í­ì£¼**ë¡œ ì¸í•´ ì „ì²´ ì„œë¹„ìŠ¤ ì‘ë‹µ ì§€ì—° ë˜ëŠ” ì¥ì•  ë°œìƒ
    - âŒ ë¶€í•˜ ë¶„ì‚° ì—†ì´ **ì„ ì°©ìˆœ ì²˜ë¦¬**ë§Œ ìˆ˜í–‰ë˜ì–´ ì‚¬ìš©ì ê²½í—˜ ì €í•˜

  ### 2. ë¶€í•˜ í…ŒìŠ¤íŠ¸ë¥¼ í†µí•œ ì„±ëŠ¥ í•œê³„ ê²€ì¦
  
  - **k6ë¥¼ ì´ìš©í•´ ë™ì‹œ ì ‘ì† ì‚¬ìš©ì 1000ëª… ìˆ˜ì¤€ìœ¼ë¡œ í…ŒìŠ¤íŠ¸**ë¥¼ ì§„í–‰í•œ ê²°ê³¼ ë‹¤ìŒê³¼ ê°™ì€ ë³‘ëª©ì´ í™•ì¸
    - ğŸ”» í‰ê·  ì‘ë‹µ ì§€ì—° ì‹œê°„: **ì•½ 9 ~ 10ì´ˆ**
    - ğŸ”» DB ì»¤ë„¥ì…˜ í’€ì˜ í¬í™”
  - ì‹¤ì œ ì„œë¹„ìŠ¤ë³´ë‹¤ ë‚®ì€ íŠ¸ë˜í”½ì—ì„œë„ **ì„±ëŠ¥ ì €í•˜**ì™€ **ì²˜ë¦¬ ë¶ˆì•ˆì •**ì´ ë°œìƒ,  
    ìˆ˜ë§Œ ëª… ë™ì‹œì ‘ì† í™˜ê²½ì—ëŠ” **í˜„ì¬ êµ¬ì¡°ë¡œëŠ” ë¬´ë¦¬**ë¼ íŒë‹¨.
  - ë”°ë¼ì„œ **ìˆœì°¨ íì‰ ì²˜ë¦¬**ë¥¼ ìœ„í•œ ëŒ€ê¸°ì—´ ì‹œìŠ¤í…œì´ í•„ìˆ˜.
  
  ### 3. ê¸°ëŠ¥ ë„ì… ê·¼ê±° ë° ì°¸ê³  ì‚¬ë¡€
  
  - **Yes24, ì¸í„°íŒŒí¬, í‹°ì¼“ë§í¬** ë“± ì£¼ìš” í‹°ì¼“íŒ… ì‚¬ì´íŠ¸ì—ì„œ ëŒ€ê¸°ì—´ í˜ì´ì§€ë¥¼ ì œê³µ
  
  </details>

</details>

<br>

<details>
<summary><strong>ğŸ”¨ ê²½ë§¤</strong></summary>

- **ê²½ë§¤ ë“±ë¡ / ì…ì°° / ìƒìœ„ ì…ì°° / ë‚™ì°°**
  
  - í‹°ì¼“íŒ… ì‹¤íŒ¨ ìœ ì €ì—ê²Œ ë˜ ë‹¤ë¥¸ ê¸°íšŒë¥¼ ì œê³µ.
  - ê²½ë§¤ ë°©ì‹ â†’ í‹°ì¼“ì˜ ê°€ì¹˜ë¥¼ ì‹œì¥ì— ë§¡ê²¨ í•©ë¦¬ì ì¸ ë°°ë¶„ ìœ ë„.
  - ê²½ê¸°ì¥ ë‹¹ ì¢Œì„ ìˆ˜ê°€ ë§ê³ (ì•½ 2ë§Œì„), ì¸ê¸° ê²½ê¸°ëŠ” ê²½ìŸ ì¹˜ì—´ â†’ **ì„±ëŠ¥ê³¼ ê³µì •ì„±, ì‚¬ìš©ìì˜ ë¶ˆí¸í•¨ ìµœì†Œí™” ì¤‘ìš”.**

</details>

<br>

<details>
<summary><strong>ğŸ”– ê³µí†µ</strong></summary>

- **ì¸ì¦/ì¸ê°€ ì„œë²„**
  
- **í¬ì¸íŠ¸ ê²°ì œ**

- **API Gateway**
  
  - MSAë¥¼ êµ¬ì„±í•˜ë‹¤ ë³´ë©´ í•˜ë‚˜ì˜ ì„œë¹„ìŠ¤ê°€ ì—¬ëŸ¬ ê°œì˜ ì„œë¹„ìŠ¤ APIë¥¼ í˜¸ì¶œí•˜ëŠ” ê²½ìš°ê°€ ë¹ˆë²ˆí•˜ê²Œ ì¼ì–´ë‚¨.
  - ì´ ê²½ìš° ê° ì„œë¹„ìŠ¤ì˜ EndPointì— ì§ì ‘ í˜¸ì¶œì„ í•˜ëŠ” ê²ƒ ë³´ë‹¤ API Gatewayë¥¼ ë§Œë“œëŠ” ê²ƒì´ ìœ ë¦¬í•˜ë‹¤.
  - **API Gatewayê°€ ì—†ëŠ” ê²½ìš°** : í•œ ì„œë¹„ìŠ¤ê°€ ìì‹ ì´ í˜¸ì¶œí•˜ë ¤ëŠ” ë‹¤ë¥¸ ì„œë¹„ìŠ¤ë“¤ì˜ endpointë¥¼ ì•Œê³  ìˆì–´ì•¼ í•˜ë©°, ì¦‰ ì´ëŠ” ì„œë¹„ìŠ¤ ê°„ì˜ ì˜ì¡´ ê´€ê³„ë¥¼ ë§Œë“œëŠ” ê²ƒìœ¼ë¡œ ê´€ë¦¬ì˜ ìš”ì†Œë¥¼ ì¦ê°€ì‹œí‚¨ë‹¤.
  
- **google reCAPTCHA ë° Rate Limiter**
  
  - google reCAPTCHA ë° Rate Limiter
  - í•œ ìœ ì €ê°€ ì•…ì˜ì ìœ¼ë¡œ ê³¼ë„í•œ ìš”ì²­ì„ ë³´ë‚´ ê³µê²©ì„ í•˜ëŠ” ê²½ìš°ì™€(ex. DDos), ì•…ì„± ë´‡ ë“¤ì´ ê³„ì •ì„ ë§ˆêµ¬ì¡ì´ë¡œ ìƒì„±í•˜ëŠ” ê²½ìš°ì— ëŒ€í•´ ìƒê°í•´ë´¤ë‹¤.
  - ê³¼ë„í•œ ìš”ì²­ì„ ë§‰ëŠ” Rate Limiter ì•Œê³ ë¦¬ì¦˜ê³¼ ì•…ì„± ë´‡ì„ ë§‰ëŠ” google reCAPTCHAë¥¼ ë„ì…í•˜ë„ë¡ ê²°ì •í–ˆë‹¤.

</details>

---

## **ğŸ§‘ğŸ»â€ğŸ’»** íŒ€ì› ì†Œê°œ

|ì´ë¦„|ì—­í• |
|----------|--------------------------------------------------------------|
|ì´ê·œì •| ê²½ë§¤ CRUD ê¸°ëŠ¥ êµ¬í˜„ <br> Redis ê¸°ë°˜ ìºì‹± ì „ëµ ë° ì´ë²¤íŠ¸ ì—°ë™ ì„¤ê³„ <br> ë™ì‹œì„± ì œì–´ |
|ì„ì—°ê±¸| ë©¤ë²„, í¬ì¸íŠ¸ CRUD <br> Spring Securityë¥¼ í†µí•œ ì¸ì¦/ì¸ê°€ êµ¬í˜„ <br> ê²°ì œ, API Gateway <br> ì„œë²„ ëª¨ë‹ˆí„°ë§ |
|ë¥˜ì„±í˜„| í‹°ì¼“, ì˜ˆë§¤ CRUD <br> ëŒ€ê¸°ì—´ ê¸°ëŠ¥ì„ í†µí•œ íŠ¸ë˜í”½ ì œì–´ <br> ë™ì‹œì„± ì œì–´ |
|ìœ¤í˜„í˜¸| ê²½ê¸°, ê²½ê¸°ì¥ ê¸°ëŠ¥ êµ¬í˜„ <br> ì„œë²„ ê°„ í†µì‹  ê¸°ë°˜ ë‚¨ì€ ì¢Œì„ ìˆ˜ ì¡°íšŒ êµ¬ì¡° ì„¤ê³„ ë° ìµœì í™” <br> Redis ê¸°ë°˜ ìºì‹± ì „ëµ ë° ì´ë²¤íŠ¸ ì—°ë™ ì„¤ê³„ |
|ì´ì¸í•™| CI/CD ë°°í¬ |

---

## ğŸ‘¤Â ì‚¬ìš©ì ì´ìš© íë¦„

<details>
<summary>í‹°ì¼“ ì˜ˆë§¤</summary>
  
![image](https://github.com/user-attachments/assets/d748a6d9-4e5d-4517-bb8b-5edf9b74e0b3)

</details>

<details>
<summary>í‹°ì¼“ ê²½ë§¤</summary>
  
![image](https://github.com/user-attachments/assets/987f36c7-d8b4-405b-84e5-6318e8d761e3)

</details>

## ğŸ”„Â ì„œë¹„ìŠ¤ ì‘ë™ íë¦„

<details>
<summary>ì¢Œì„ ì„ ì  ë° í‹°ì¼“ ì˜ˆë§¤</summary>
    
![image](https://github.com/user-attachments/assets/3291a526-5fd8-4653-8428-2b3225a80b52)

</details>

<details>
<summary>ê²½ë§¤</summary>
    
![image](https://github.com/user-attachments/assets/a322c68f-3eb5-44ea-b0b2-ab605e4f1304)

</details>

---

## ğŸ—ï¸Â System Architecture

![image](https://github.com/user-attachments/assets/9648cdcd-1d9a-459e-98b7-e93b7412e6e2)

---

## ğŸ“˜ ì„¤ê³„ ë¬¸ì„œ

- **API ëª…ì„¸ì„œ**
    
    [ticketable](https://documenter.getpostman.com/view/27492121/2sB2j4eAeL)

- **ERD**
    
    ![image](https://github.com/user-attachments/assets/804a6aaa-3b8a-4bab-8531-76938a6ee100)
  
---

## ğŸ› ï¸Â ê¸°ìˆ  ìŠ¤íƒ

![image](https://github.com/user-attachments/assets/9a4f3056-43ba-484d-b2b0-03e17fc2eee1)

---


## ğŸ¦Â ê¸°ìˆ ì  ì˜ì‚¬ê²°ì • ë° ì„±ëŠ¥ ê°œì„ 

<details>
<summary><strong>MSA ë¶„ë¦¬ í›„ ì„œë²„ ê°„ì˜ í†µì‹  ë°©ë²• ì„ íƒ</strong></summary>

### 1. ë°°ê²½

  ì´ˆê¸°ì—ëŠ” ëª¨ë†€ë¦¬ì‹ êµ¬ì¡°ì—ì„œ ê°œë°œì„ ì‹œì‘í–ˆìœ¼ë©°, **ë„ë©”ì¸ ì±…ì„ ë¶„ë¦¬**, **ì¥ì•  ê²©ë¦¬**ë¥¼ ìœ„í•´ MSA êµ¬ì¡°ë¡œ ì „í™˜í–ˆìŠµë‹ˆë‹¤. ì´ë¥¼ ìœ„í•´ **ë„ë©”ì¸ ì¤‘ì‹¬ ìˆ˜ì§ ë¶„ë¦¬(Vertical Slice Architecture)** ì™€ ëª¨ë“ˆ ê¸°ë°˜ ê°œë°œì„ ì ìš©í–ˆê³ , ì´í›„ ê° ë„ë©”ì¸ì„ ë…ë¦½ ì„œë¹„ìŠ¤ë¡œ ë¶„ë¦¬í•˜ì—¬ í†µì‹ ì´ í•„ìš”í•œ êµ¬ì¡°ë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.
    
  ì´ì— ë”°ë¼ ì„œë²„ ê°„ í†µì‹ ì´ í•„ìˆ˜ ìš”ì†Œê°€ ë˜ì—ˆìŠµë‹ˆë‹¤

<br>

### 2. ìš”êµ¬ì‚¬í•­

- í‹°ì¼“íŒ… ë° ê²½ë§¤ ì‹œìŠ¤í…œì€ ëŒ€ê·œëª¨ ë™ì‹œ íŠ¸ë˜í”½ì´ ì§‘ì¤‘ë˜ëŠ” ì‹¤ì‹œê°„ ì„œë¹„ìŠ¤ ì…ë‹ˆë‹¤. íŠ¹íˆ ì˜ˆë§¤ ì˜¤í”ˆ ì‹œê°„ì—ëŠ” ë‹¨ ì‹œê°„ë‚´ì— ìˆ˜ì‹­ë§Œ ê±´ì˜ ì¡°íšŒì™€ ìˆ˜ì²œê±´ì˜ ì˜ˆë§¤ ìš”ì²­ì´ ë°œìƒí•©ë‹ˆë‹¤.
- ë”°ë¼ì„œ ì¡°ê¸ˆì´ë¼ë„ ëŒ€ìš©ëŸ‰ì˜ íŠ¸ë˜í”½ì—ì„œ ì„±ëŠ¥ì„ ìœ ì§€í•˜ê¸° ìœ„í•´ì„œ ì„œë²„ ê°„ì˜ í†µì‹ ì—ì„œë„ ì„±ëŠ¥ì„ ë†’í í•„ìš”ê°€ ìˆìŠµë‹ˆë‹¤!

<br>

### 3. ê³ ë ¤í•œ ëŒ€ì•ˆ

MSA ì „í™˜ ì´í›„ ì„œë²„ ê°„ ë°ì´í„° ì „ë‹¬ì„ ìœ„í•´ ë‹¤ìŒ ì„¸ ê°€ì§€ ë°©ì‹ì„ ë„ì… ë° í…ŒìŠ¤íŠ¸í–ˆìŠµë‹ˆë‹¤.
    
| í•­ëª© | Feign Client | gRPC | RSocket |
| --- | --- | --- | --- |
| í†µì‹  ë°©ì‹ | HTTP/1.1 + JSON | HTTP/2 + Protobuf | TCP/WebSocket + Binary |
| êµ¬ì¡° | ì„ ì–¸í˜• HTTP ì¸í„°í˜ì´ìŠ¤ | ê³ ì„±ëŠ¥ RPC í”„ë ˆì„ì›Œí¬ | Reactive ë¹„ë™ê¸° ë©”ì‹œì§• |
| ì§ë ¬í™” | JSON (í…ìŠ¤íŠ¸ ê¸°ë°˜) | Protobuf (ì´ì§„) | ì´ì§„ |
| íŠ¹ì§• | ì„¤ì • ê°„ë‹¨, Spring ì¹œí™”ì  | ë¹ ë¥´ê³  ê²½ëŸ‰, ì•ˆì •ì  | ì–‘ë°©í–¥ ìŠ¤íŠ¸ë¦¬ë°, Backpressure ì§€ì› |
| ì„±ëŠ¥ | ë‚®ìŒ (ë¶€í•˜ ì‹œ ë³‘ëª© ë°œìƒ) | ìš°ìˆ˜ (ë‚®ì€ ì§€ì—° + ì•ˆì •ì ) | ìš°ìˆ˜ (ì§€ì—° ìµœì†Œí™”) |
| ì‘ë‹µ ì²˜ë¦¬ | ë™ê¸° ì²˜ë¦¬ | ë™ê¸° or ë¹„ë™ê¸° | ê¸°ë³¸ ë¹„ë™ê¸° (Mono/Flux) |
| ìºì‹œ ì—°ë™ | ì‰¬ì›€ | ì‰¬ì›€ | âš ï¸ `.block()` í•„ìš” â†’ ë³‘ëª© ë°œìƒ ê°€ëŠ¥ |
| ì‚¬ìš© ì í•©ì„± | ê°„ë‹¨í•œ ë‚´ë¶€ í˜¸ì¶œ | ê³ ì„±ëŠ¥ ì„œë²„ ê°„ í†µì‹  | ì‹¤ì‹œê°„ ë°ì´í„° ìŠ¤íŠ¸ë¦¬ë° ë“± |

<br>

### 4. ì‹¤í—˜ ë°©ë²• ë° ê²°ê³¼ ìš”ì•½
    
  **ê³µí†µ ì‹¤í—˜ í™˜ê²½**
    
  - 5ë¶„ê°„ ì¢Œì„ ì¡°íšŒ ì•½ 20ë§Œ ê±´ / ì¢Œì„ ì„ ì  ì•½ 5,000ê±´
  - ì´ˆë°˜ ê³¼ë¶€í•˜ â†’ ì ì°¨ ê°ì†Œí•˜ëŠ” ì‹¤ì œ ì˜ˆë§¤ íŒ¨í„´ ì‹œë®¬ë ˆì´ì…˜
  - ë§¤ í…ŒìŠ¤íŠ¸ ì „ ìºì‹œ ì‚­ì œ, ì¡°íšŒ ì¿¼ë¦¬ 3ì¢… ëœë¤ í˜¸ì¶œ
    
    **ê²°ê³¼ ìš”ì•½**
    
    | í†µì‹  ë°©ì‹ | í‰ê·  ì‘ë‹µ(ms) | P90 | P95 | ì‹¤íŒ¨ìœ¨ | íŠ¹ì§• |
    | --- | --- | --- | --- | --- | --- |
    | Feign | 10.78 | 13.41 | 14.99 | 0% |  |
    | Feign | 4.75 | 10.23 | 15.97 | 0% |  |
    | gRPC | 5.06 | 3.16 | 7.93 | 0% |  |
    | gRPC | 4.86 | 3.65 | 6.0 | 0% |  |
    | RSocket | 11.19 | 3.93 | 7.82 | 0% | ì²« ìºì‹œ gRPC ìƒì„± |
    | RSocket | 3.46 | 3.99 | 5.99 | 0% | ì²« ìºì‹œ gRPC ìƒì„± |

    ![image](https://github.com/user-attachments/assets/814df80f-0a22-4533-a220-322bf738f7c6)

<br>

### 5. ê²°ì • ë° ê·¼ê±°
    
ìœ„ í…ŒìŠ¤íŠ¸ë¥¼ ê¸°ë°˜, RSocketê³¼ gRPC ëª¨ë‘ Feign ëŒ€ë¹„ 20~50% ì •ë„ì˜ ë¹ ë¥¸ ì‘ë‹µ ì‹œê°„ì„ ë³´ì—¬ì¤Œ
    
- RSocketì€ ê¸°ë³¸ì ìœ¼ë¡œ **ë¹„ë™ê¸° Mono/Flux ê¸°ë°˜ ì‘ë‹µ êµ¬ì¡°**
- ê·¸ëŸ¬ë‚˜ Springì˜ `@Cacheable`ì€ **ë™ê¸° ë°©ì‹ë§Œ ì§€ì›**
- RSocketì˜ ì‘ë‹µì„ `.block()`ìœ¼ë¡œ ì²˜ë¦¬ ì‹œ:
  - ë¹„ë™ê¸° ì²˜ë¦¬ ë¬´ë ¥í™”
  - ì´ë²¤íŠ¸ ìˆ˜ì‹  ì§€ì—° ë° ì¥ì•  ê°€ëŠ¥ì„± (ì‹¤ì œ Redis Pub/Sub ìˆ˜ì‹  ì‹¤íŒ¨ ë°œìƒ)
    
    â†’ ê²°ê³¼ì ìœ¼ë¡œ RSocketì€ **ìºì‹œ ì´ˆê¸°í™” ë˜ëŠ” ê°±ì‹  ë¡œì§ê³¼ì˜ ê¶í•©ì´ ì¢‹ì§€ ì•ŠìŒ**
    
    > gRPCë¥¼ ì„œë²„ ê°„ í†µì‹  ë°©ì‹ìœ¼ë¡œ ì±„íƒ
    > 
    
**ê²°ì • ì´ìœ :**

- Feignë³´ë‹¤ ìš°ìˆ˜í•œ ì„±ëŠ¥ (P90/P95 ê¸°ì¤€ 50% ì´ìƒ ê°œì„ )
- RSocket ìˆ˜ì¤€ì˜ ì‘ë‹µ ì‹œê°„ í™•ë³´
- Spring ê¸°ë°˜ êµ¬ì¡°ì™€ì˜ ë†’ì€ í˜¸í™˜ì„±
- ë™ê¸° ìºì‹œ ë¡œì§ê³¼ë„ ì¶©ëŒ ì—†ì´ í†µí•© ê°€ëŠ¥

<br>
    
### 6. ì½”ë“œ

- Feign Client
    
    ```java
    @FeignClient(name = "ticket", url = "http://localhost:8082")
    public interface TicketClient {
        @GetMapping("/api/tickets/games/{gameId}")
        Set<Long> getBookedSeatsId(@PathVariable("gameId") Long gameId);
    }
    ```
    
- gRPC
    - .proto íŒŒì¼
    
    ```java
    // ticket.proto
    syntax = "proto3";
    
    option java_multiple_files = true;
    option java_package = "com.example.grpc.ticket";
    option java_outer_classname = "TicketProto";
    
    package ticket;
    
    service TicketService {
      // ì˜ˆë§¤ëœ ì¢Œì„ ID ë¦¬ìŠ¤íŠ¸ ì¡°íšŒ
      rpc GetBookedSeatIds (BookedSeatsRequest) returns (BookedSeatsResponse);
    }
    
    message BookedSeatsRequest {
      int64 gameId = 1;
    }
    
    message BookedSeatsResponse {
      repeated int64 seatIds = 1;
    }
    ```
    
    - proto ì»´íŒŒì¼ ì„¤ì •
    
    ```java
    plugins {
        id 'com.google.protobuf' version '0.9.4'
    }
    
    dependencies {
        // gRPC
        implementation 'io.grpc:grpc-netty-shaded:1.64.0'
        implementation 'io.grpc:grpc-protobuf:1.64.0'
        implementation 'io.grpc:grpc-stub:1.64.0'
        implementation 'com.google.protobuf:protobuf-java:3.25.3'
        implementation 'org.springframework.boot:spring-boot-starter'
        implementation 'javax.annotation:javax.annotation-api:1.3.2'
    }
    
    protobuf {
        protoc {
            artifact = "com.google.protobuf:protoc:3.25.3"
        }
        plugins {
            grpc {
                artifact = "io.grpc:protoc-gen-grpc-java:1.64.0"
            }
        }
        generateProtoTasks {
            all().each { task ->
                task.plugins {
                    grpc {}
                }
            }
        }
    }
    ```
    
    - ì„œë²„ êµ¬í˜„
    
    ```java
    @Configuration
    @RequiredArgsConstructor
    public class GrpcServerRunner {
    
        @Value("${grpc.port:9090}")
        private int port;
    
        private final TicketServiceGrpc.TicketServiceImplBase ticketService;
    
        @PostConstruct
        public void startGrpcServer() throws IOException {
            Server server = ServerBuilder
                    .forPort(port)
                    .addService(ticketService)
                    .build()
                    .start();
    
            System.out.println("âœ… gRPC ì„œë²„ ì‹œì‘ë¨. í¬íŠ¸: " + port);
    
            // JVM ì¢…ë£Œ ì‹œ gRPC ì„œë²„ë„ ì¢…ë£Œë˜ë„ë¡ í›„í‚¹
            Runtime.getRuntime().addShutdownHook(new Thread(server::shutdown));
    
            // gRPC ì„œë²„ëŠ” ë¸”ë¡œí‚¹ì´ë¯€ë¡œ ë³„ë„ ì“°ë ˆë“œë¡œ ì‹¤í–‰
            new Thread(() -> {
                try {
                    server.awaitTermination();
                } catch (InterruptedException e) {
                    Thread.currentThread().interrupt(); // ì¸í„°ëŸ½íŠ¸ ìƒíƒœ ë³µì› (ê¶Œì¥)
                    System.err.println("gRPC ì„œë²„ ëŒ€ê¸° ì¤‘ ì¸í„°ëŸ½íŠ¸ ë°œìƒ: " + e.getMessage());
                }
            }).start();
        }
    }
    ```
    
    - ì„œë²„ êµ¬í˜„ì²´ ì½”ë“œ êµ¬í˜„
    
    ```java
    @Service
    @RequiredArgsConstructor
    public class TicketGrpcService extends TicketServiceGrpc.TicketServiceImplBase {
        private final ReservationService reservationService; // ê¸°ì¡´ ì¢Œì„ ì¡°íšŒ ì„œë¹„ìŠ¤
    
        @Override
        public void getBookedSeatIds(BookedSeatsRequest request, StreamObserver<BookedSeatsResponse> responseObserver) {
            try {
                Long gameId = request.getGameId(); // ìš”ì²­ì—ì„œ gameId ì¶”ì¶œ
                Set<Long> seatIds = reservationService.getBookedSeatsId(gameId); // ì˜ˆì•½ëœ ì¢Œì„ ID ì¡°íšŒ
    
                BookedSeatsResponse response = BookedSeatsResponse.newBuilder()
                        .addAllSeatIds(seatIds) // ì¡°íšŒ ê²°ê³¼ë¥¼ ì‘ë‹µ ë©”ì‹œì§€ì— ì¶”ê°€
                        .build();
    
                responseObserver.onNext(response); // ê²°ê³¼ ë°˜í™˜
                responseObserver.onCompleted();    // ìŠ¤íŠ¸ë¦¼ ì¢…ë£Œ
            } catch (Exception e) {
                responseObserver.onError(e); // ì—ëŸ¬ê°€ ë°œìƒí•˜ë©´ í´ë¼ì´ì–¸íŠ¸ì— ì—ëŸ¬ ì „ë‹¬
            }
        }
    }
    ```
    
    - í´ë¼ì´ì–¸íŠ¸ ì„¤ì • íŒŒì¼
    
    ```java
    @Configuration
    public class GrpcClientConfig {
    
        @Bean
        public TicketServiceGrpc.TicketServiceBlockingStub ticketServiceBlockingStub() {
            ManagedChannel channel = ManagedChannelBuilder
                    .forAddress("localhost", 9092) // í‹°ì¼“ ì„œë²„ ì£¼ì†Œ/í¬íŠ¸
                    .usePlaintext() // TLS ì—†ì´ í†µì‹ 
                    .build();
            return TicketServiceGrpc.newBlockingStub(channel);
        }
    }
    ```
    
    - í´ë¼ì´ì–¸íŠ¸ í˜¸ì¶œ ë° ì‚¬ìš©
    
    ```java
    @Service
    @RequiredArgsConstructor
    public class GameGrpcClientService {
        private final TicketServiceGrpc.TicketServiceBlockingStub ticketServiceBlockingStub;
        public Set<Long> getBookedSeatIds(Long gameId) {
            BookedSeatsRequest request = BookedSeatsRequest.newBuilder()
                    .setGameId(gameId)
                    .build();
    
            BookedSeatsResponse response = ticketServiceBlockingStub.getBookedSeatIds(request);
    
            return response.getSeatIdsList().stream().collect(Collectors.toSet());
        }
    }
    
    // ì‚¬ìš© ex
    @Cacheable(
            value = "seat",  // ìºì‹œ ì´ë¦„
            key = "T(String).format('%s:%s', #gameId, #sectionId)"  // ì¡°ê±´ ì¡°í•© key
    )
    public List<SeatGetResponse> getSeatsCached(Long sectionId, Long gameId) {
        log.info("ğŸ’¡ ìºì‹œ ë¯¸ì ì¤‘! DBì—ì„œ seat ì¡°íšŒ");
        Set<Long> bookedSeatsId = gameGrpcClientService.getBookedSeatIds(gameId);
        return seatInfo(sectionId, bookedSeatsId);
    }
    ```
    
- RSocket
    - ì˜ì¡´ì„± ì£¼ì…
    
    ```java
    implementation 'org.springframework.boot:spring-boot-starter-rsocket'
    ```
    
    - ì„œë²„ êµ¬ì„±
    
    ```java
    @Controller
    @RequiredArgsConstructor
    public class TicketRSocketController {
    
        private final TicketService ticketService;
    
    	@MessageMapping("ticket.bookedSeats")
    	public Mono<Set<Long>> getBookedSeats(Long gameId) {
    		return Mono.fromCallable(() -> reservationService.getBookedSeatsId(gameId));
    	}
    }
    ```
    
    - í´ë¼ì´ì–¸íŠ¸ ì„¤ì • íŒŒì¼
    
    ```java
    @Configuration
    public class RSocketClientConfig {
    
        @Bean
        public RSocketRequester rSocketRequester(RSocketRequester.Builder builder) {
            return builder
                    .tcp("localhost", 7000);
        }
    }
    ```
    
    - í´ë¼ì´ì–¸íŠ¸ êµ¬ì„±
    
    ```java
    @Service
    @RequiredArgsConstructor
    public class GameRSocketClientService {
    
        private final RSocketRequester rSocketRequester;
        public Mono<Set<Long>> getBookedSeatIds(Long gameId) {
            return rSocketRequester
                    .route("ticket.bookedSeats")           // ì„œë²„ì˜ @MessageMappingê³¼ ì¼ì¹˜í•´ì•¼ í•¨
                    .data(gameId)                          // ë³´ë‚´ëŠ” ë°ì´í„°
                    .retrieveMono(new ParameterizedTypeReference<Set<Long>>() {});
        }
    }
    
    // ì‹¤ì œ ì‚¬ìš©
    public Mono<Void> handleAfterTicketChangeAll(Long gameId, Long seatId) {
        Seat seat = seatService.getSeat(seatId);
        String sectionType = seat.getSection().getType();
        Long sectionId = seat.getSection().getId();
        return gameRSocketClientService.getBookedSeatIds(gameId)
                .doOnNext(bookedSeatsId -> {
                    handleAfterTicketChange(gameId, bookedSeatsId);
                    handleAfterTicketChangeByType(gameId, sectionType, bookedSeatsId);
                    handleAfterTicketChangeBySeat(gameId, sectionId, bookedSeatsId);
                })
                .doOnError(e -> log.error("âŒ bookedSeatIds ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨", e))
                .then(); // Mono<Void> ë°˜í™˜
     }
    ```
    
<br>
    
### 7. í–¥í›„ ê³ ë ¤ ì‚¬í•­

- ì‹¤ì‹œê°„ ìŠ¤íŠ¸ë¦¬ë° ë˜ëŠ” ì‚¬ìš©ì ê°„ ì¸í„°ë™ì…˜ í†µì‹ ì—ëŠ” í–¥í›„ RSocket ë³„ë„ ì±„íƒ ê°€ëŠ¥

</details>

<details>
<summary><strong>MSA ë¶„ë¦¬ í›„ ìºì‹œ ì „í™˜</strong></summary>

### 1. ë°°ê²½

ê¸°ì¡´ì—ëŠ” ë‹¨ì¼ ì„œë²„ ë‚´ì—ì„œ Caffeine ìºì‹œë¥¼ ì‚¬ìš©í•˜ì—¬ ì¡°íšŒ ì‘ë‹µ ì„±ëŠ¥ì„ ê°œì„ í•´ ì™”ìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ MSA êµ¬ì¡°ë¡œ ì „í™˜ë˜ë©°, **ì„œë²„ ê°„ ë„ë©”ì¸ì´ ë¶„ë¦¬ë˜ê³  DBë„ ë…ë¦½ì ìœ¼ë¡œ êµ¬ì„±**ë¨ì— ë”°ë¼ Caffeineì²˜ëŸ¼ ì¸ë©”ëª¨ë¦¬ ê¸°ë°˜ì˜ ë¡œì»¬ ìºì‹œëŠ” **ê³µìœ ê°€ ë¶ˆê°€ëŠ¥í•œ êµ¬ì¡°**ê°€ ë˜ì—ˆìŠµë‹ˆë‹¤.

<br>

### 2. ìš”êµ¬ì‚¬í•­

- MSA í™˜ê²½ì—ì„œëŠ” **ì—¬ëŸ¬ ì¸ìŠ¤í„´ìŠ¤/ì„œë¹„ìŠ¤ ê°„ ìºì‹œ ë™ê¸°í™”**ê°€ í•„ìˆ˜
- ì‹¤ì‹œê°„ í‹°ì¼“íŒ… ì‹œìŠ¤í…œ íŠ¹ì„±ìƒ ì¡°íšŒ ì„±ëŠ¥ì€ ì‚¬ìš©ì ê²½í—˜ê³¼ ì§ê²°
- ë°ì´í„° ë³€ê²½ì´ ë°œìƒí•˜ëŠ” ì„œë¹„ìŠ¤ì™€ ì¡°íšŒ ì„œë¹„ìŠ¤ê°€ ë¶„ë¦¬ë˜ì–´ ìˆëŠ” êµ¬ì¡°

<br>

### 3. ê³ ë ¤í•œ ëŒ€ì•ˆ

| í•­ëª© | Caffeine (ê¸°ì¡´) | Redis (ë„ì…) |
| --- | --- | --- |
| êµ¬ì¡° | ë‹¨ì¼ ì¸ìŠ¤í„´ìŠ¤ ë©”ëª¨ë¦¬ ê¸°ë°˜ | ë„¤íŠ¸ì›Œí¬ ê¸°ë°˜ ê¸€ë¡œë²Œ ìºì‹œ |
| ê³µìœ  ê°€ëŠ¥ì„± | âŒ ë¶ˆê°€ | âœ… ê°€ëŠ¥ |
| MSA ì í•©ë„ | ë‚®ìŒ | ë†’ìŒ |
| ì†ë„ | ë¹ ë¦„ (ë¡œì»¬) | ë¹ ë¦„ (ë„¤íŠ¸ì›Œí¬ ê¸°ì¤€) |
| í™•ì¥ì„± | ë‚®ìŒ | ë†’ìŒ |

<br>

### 4. ê²°ì • ë° ê·¼ê±°

- ì¢Œì„ ì˜ˆì•½/ì·¨ì†ŒëŠ” Ticket ì„œë¹„ìŠ¤ì—ì„œ ë°œìƒ
- í•˜ì§€ë§Œ ìºì‹œëŠ” Game ì„œë¹„ìŠ¤ì— ì¡´ì¬ â†’ ë°ì´í„° ë³€ê²½ì´ ë°œìƒí•´ë„ ìºì‹œ ê°±ì‹  X
- ê²°ê³¼ì ìœ¼ë¡œ ìºì‹œ ë¶ˆì¼ì¹˜ ë°œìƒ
  - â†’ Redis Pub/Sub ê¸°ë°˜ ì´ë²¤íŠ¸ ì²˜ë¦¬ ë°©ì‹ ë„ì…
  - Ticket ì„œë¹„ìŠ¤ì—ì„œ ì˜ˆë§¤/ì·¨ì†Œ ì‹œ ì´ë²¤íŠ¸ ë°œí–‰
  - Game ì„œë¹„ìŠ¤ëŠ” í•´ë‹¹ ì´ë²¤íŠ¸ ìˆ˜ì‹  í›„ ìºì‹œ ê°±ì‹  ìˆ˜í–‰
    
ê°œì„  íš¨ê³¼
    
- ìºì‹œ ê°±ì‹  ì‹œì ì„ ëª…í™•íˆ ì»¨íŠ¸ë¡¤ â†’ ë¶ˆì¼ì¹˜ ë¬¸ì œ í•´ê²°
- ì„œë¹„ìŠ¤ ê°„ ëŠìŠ¨í•œ ê²°í•© êµ¬ì¡° ìœ ì§€
- ì •ìƒì ìœ¼ë¡œ ìºì‹œ ê¸°ëŠ¥ êµ¬í˜„ ì™„ë£Œë¥¼ í†µí•œ ì„±ëŠ¥ ê°œì„ 

<br>

### 5. ì½”ë“œ

- ì½”ë“œ
    - ì„¤ì • íŒŒì¼
    
    ```java
    @Configuration
    public class RedisSubscriberConfig {
        @Bean
        public MessageListenerAdapter messageListener(RedisEventListener listener) {
            return new MessageListenerAdapter(listener, "onMessage");
        }
    
        @Bean
        public RedisMessageListenerContainer container(
                RedisConnectionFactory factory,
                MessageListenerAdapter adapter) {
            RedisMessageListenerContainer container = new RedisMessageListenerContainer();
            container.setConnectionFactory(factory);
            container.addMessageListener(adapter, new ChannelTopic("reservation"));
            return container;
        }
    }
    ```
    
    - publisher
    
    ```java
    @RequiredArgsConstructor
    @Component
    @Slf4j
    public class TicketPublisher {
    
        private final RedisTemplate<String, Object> redisTemplate;
    
        public void publish(TicketEvent event) {
            log.info("ìºì‹œ ì´ˆê¸°í™”ë¥¼ ìœ„í•œ ì´ë²¤íŠ¸ ë°œí–‰");
            redisTemplate.convertAndSend("reservation", event);
        }
    }
    ```
    
    - listener
    
    ```java
    @Slf4j
    @Component
    @RequiredArgsConstructor
    public class RedisEventListener implements MessageListener {
        private final ObjectMapper objectMapper;
        private final GameCacheService gameCacheService;
    
        public void onMessage(Message message, byte[] pattern) {
            try {
                String json = new String(message.getBody());
                TicketEvent event = objectMapper.readValue(json, TicketEvent.class);
    
                // ìºì‹œ ê°±ì‹  ì²˜ë¦¬
                gameCacheService.handleAfterTicketChangeAll(event.getGameId(), event.getSeatId());
    
                log.info("âœ… í‹°ì¼“ ë³€ê²½ ì´ë²¤íŠ¸ ìˆ˜ì‹  - gameId: {}", event.getGameId());
    
            } catch (Exception e) {
                log.error("âŒ ì´ë²¤íŠ¸ ìˆ˜ì‹  ì¤‘ ì—ëŸ¬ ë°œìƒ", e);
            }
        }
    }
    ```
    
    - ì´ë²¤íŠ¸ ë°œìƒ
    
    ```java
    // ì¢Œì„ ì„ ì  ë°œìƒ
    	public ReservationResponse processReserve(AuthUser auth, ReservationCreateRequest reservationCreateRequest) {
    		seatHoldRedisUtil.holdSeatAtomic(
    			reservationCreateRequest.getGameId(),
    			reservationCreateRequest.getSeatIds(),
    			String.valueOf(auth.getMemberId())
    		);
    		try {
    			ReservationResponse reservation = reservationCreateService.createReservation(
    				auth,
    				reservationCreateRequest
    			);
    			// í•´ë‹¹ ì§€ì ì—ì„œ ìºì‹œ ì´ë²¤íŠ¸ ë°œìƒ
    			TicketEvent ticketEvent = new TicketEvent(
    				reservationCreateRequest.getGameId(),
    				reservationCreateRequest.getSeatIds().get(0)
    			);
    			ticketPublisher.publish(ticketEvent);
    
    			return reservation;
    		} catch (Exception e) {
    			seatHoldRedisUtil.releaseSeatAtomic(reservationCreateRequest.getSeatIds(),reservationCreateRequest.getGameId());
    			throw e;
    		}
    	}
    ```

<br>

### 6. í–¥í›„ ê³ ë ¤ ì‚¬í•­
    
- Redis Pub/Subì˜ ë©”ì‹œì§€ ì˜ì†ì„± í•œê³„ ê³ ë ¤
- ì¶”í›„ Kafka ê¸°ë°˜ ë©”ì‹œì§• ì‹œìŠ¤í…œ ì „í™˜ ê²€í† 
  - ë©”ì‹œì§€ ìœ ì‹¤ ë°©ì§€
  - ë©€í‹° êµ¬ë…ì ì²˜ë¦¬ ìš©ì´
  - ì´ë²¤íŠ¸ ë¦¬í”Œë ˆì´ ê¸°ëŠ¥ ë“± ì¶”ê°€ ê¸°ëŠ¥ í™•ë³´

</details>

<details>
<summary><strong>ì„œë²„ ëª¨ë‹ˆí„°ë§ ë°©ë²• ì„ íƒ</strong></summary>
    
 ### 1. ë°°ê²½
    
- í‹°ì¼“íŒ…ì„ ìˆ˜í–‰í•˜ëŠ” ê³¼ì •ì—ì„œ ë§ì€ ì–‘ì˜ íŠ¸ë˜í”½ì´ ëª°ë¦¬ë„ë¡ í…ŒìŠ¤íŠ¸ë¥¼ í•´ë´¤ëŠ”ë°, ì„œë²„ê°€ ë²„í‹°ì§€ ëª»í•˜ê³  ë‹¤ìš´ë˜ëŠ” ê²½ìš°ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.
- ì´ ìƒí™©ì„ ë³´ê³  ì„œë¹„ìŠ¤ ì„œë²„ì˜ ìƒíƒœë¥¼ ì²´í¬ í•´ì£¼ëŠ” ëª¨ë‹ˆí„°ë§ ì„œë²„ì˜ í•„ìš”ì„±ì„ ëŠê¼ˆìŠµë‹ˆë‹¤.

<br>
    
### 2. ìš”êµ¬ì‚¬í•­
    
- **ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§** : ì‹¤ì‹œê°„ìœ¼ë¡œ ì„œë²„ì˜ ìƒíƒœë¥¼ ëª¨ë‹ˆí„°ë§ í•  ìˆ˜ ìˆì–´ì•¼ í•œë‹¤.
- **ì•Œë¦¼ ê¸°ëŠ¥** : ì„œë²„ì— ë¬¸ì œê°€ ë°œìƒí–ˆì„ ë•Œ ì•Œë¦¼ì„ ë°›ì„ ìˆ˜ ìˆì–´ì•¼ í•œë‹¤.

<br>
    
### 3. ê³ ë ¤í•œ ëŒ€ì•ˆ
    
| **ë¹„êµ í•­ëª©** | **ì¥ì ** | **ë‹¨ì ** |
| --- | --- | --- |
| **Prometheus** | 1. **ì‹¤ì‹œê°„ ì„œë²„ ëª¨ë‹ˆí„°ë§ê³¼ ë°ì´í„° ì‹œê°í™”ì— ë›°ì–´ë‚˜ë‹¤.** <br> 2. **Grafanaì™€ í•¨ê»˜ ì‚¬ìš©í•˜ë©´ ë°ì´í„° ì‹œê°í™”ê°€ ê°€ëŠ¥í•´ ì‹¤ì‹œê°„ ì„±ëŠ¥ ìƒíƒœë¥¼ í•œ ëˆˆì— ì•Œì•„ë³´ê¸° ì‰½ë‹¤.** | **ì£¼ë¡œ ë‹¨ê¸°ì ì¸ ëª¨ë‹ˆí„°ë§ì— ìµœì í™” ë˜ì–´ ìˆê¸° ë•Œë¬¸ì— ì¥ê¸°ì ì¸ ì €ì¥ì„ ìœ„í•´ì„  ì™¸ë¶€ ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ê°€ í•„ìš”í•˜ë‹¤.** |
| **Zabbix** | **ê°•ë ¥í•œ ì‚¬ìš©ì ì»¤ë®¤ë‹ˆí‹°ë¥¼ ê°€ì§€ê³  ìˆìœ¼ë©°, ë†’ì€ ìˆ˜ì¤€ì˜ ì»¤ìŠ¤í„°ë§ˆì´ì§•ì„ ê°€ì§€ê³  ìˆì–´ ì„œë²„ ê´€ë¦¬ì— ìµœì í™” ë¼ìˆë‹¤.** | **Spring boot Actuator ì§ì ‘ ì—°ë™ ì§€ì›ì´ ì•½í•˜ë©°, UI ë°˜ì‘ì„±ì´ ì•ˆì¢‹ê³  ì´ˆê¸° ì„¤ì •ì´ ë³µì¡í•˜ë‹¤.** |
| **New Relic** | **ì„œë²„ì˜ ì„±ëŠ¥ ë°ì´í„° ë¿ë§Œì´ ì•„ë‹Œ ì• í”Œë¦¬ì¼€ì´ì…˜ ë°ì´í„°ë„ í•¨ê»˜ ì œê³µí•´ ë‹¤ì–‘í•œ ê´€ì ì—ì„œ ì„±ëŠ¥ì„ ê´€ë¦¬í•  ìˆ˜ ìˆë‹¤.** | **ì‚¬ìš©ëŸ‰ê³¼ ë°ì´í„° ì–‘ì´ ì¦ê°€í•¨ì— ë”°ë¼ ë¹„ìš©ì´ ë§ì´ ë“¤ë©°, ê¸°ëŠ¥ì´ ë„ˆë¬´ ë‹¤ì–‘í•´ ì‹ ê·œ ì‚¬ìš©ìì—ê²ŒëŠ” ì–´ë ¤ìš¸ ìˆ˜ ìˆë‹¤.** |

<br>

### 4. ê²°ì • ë° ê·¼ê±°
    
**âœ… Prometheus + Grafana**
    
- ì˜¤í”ˆì†ŒìŠ¤ê°€ ë¬´ë£Œ
- ì´ˆê¸° ì„¤ì •ì´ êµ‰ì¥íˆ ê°„í¸í•¨
- ìš”êµ¬ ì‚¬í•­ì¸ ë°ì´í„° ì‹œê°í™”ê°€ ë›°ì–´ë‚˜ë©°, AlertManagerë¡œ ì•Œë¦¼ ê´€ë¦¬ë„ ê°€ëŠ¥
- í•˜ë“œì›¨ì–´ì˜ ìƒíƒœì™€ ì»¤ë„ ê´€ë ¨ ë©”íŠ¸ë¦­ì„ ìˆ˜ì§‘í•˜ëŠ” Node Exporterë„ ì‚¬ìš© ê°€ëŠ¥
- í•˜ë“œì›¨ì–´ì˜ ìƒíƒœì™€ ì»¤ë„ ê´€ë ¨ ë©”íŠ¸ë¦­ì„ ìˆ˜ì§‘í•˜ëŠ” Node Exporterë„ ì‚¬ìš© ê°€ëŠ¥
<br>

- **ì ìš© ì´ë¯¸ì§€**
  - ì„œë¹„ìŠ¤ ì„œë²„ ìƒíƒœ

    ![image](https://github.com/user-attachments/assets/373f5956-23d7-4ace-a127-1caa99a61947)
        
  - ëª¨ë‹ˆí„°ë§ ì„œë²„ ìƒíƒœ

    ![image](https://github.com/user-attachments/assets/38e429c4-ff0b-4884-b7ba-9aeaa41fcfd4)

<br>
    
### 5. ì½”ë“œ
    
- **docker-compose.yml**
        
  ```java
        version: '3.8'
        
        services:
          prometheus:
            image: prom/prometheus:latest
            container_name: prometheus
            ports:
              - "9091:9090"
            volumes:
              - ./prometheus.yml:/etc/prometheus/prometheus.yml:ro
        
          grafana:
            image: grafana/grafana:latest
            container_name: grafana
            user: "admin"
            ports:
              - "3030:3000"
            volumes:
              - ./grafana-data:/var/lib/grafana
            depends_on:
              - prometheus
        
          node-exporter:
            image: prom/node-exporter:latest
            container_name: node-exporter
            restart: always
            network_mode: host
        
        volumes:
          grafana-data:
  ```
        
- **prometheus.yml**
        
  ```java
        global:
          scrape_interval: 10s
        
        scrape_configs:
          - job_name: "spring-boot-server"
            metrics_path: /actuator/prometheus
            static_configs:
              - targets: ["3.39.237.240:8080"]
        
          - job_name: "node-exporter"
            static_configs:
              - targets: ["3.37.207.64:9100"]
  ```
        
<br>
    
 ### 6. í–¥í›„ ê³ ë ¤ ì‚¬í•­
    
  - **ë§Œì•½ ì˜ˆì‚°ì´ ì¶©ë¶„í•˜ê³  APM ì‹¬í™” ê¸°ëŠ¥ì´ í•„ìš”í•˜ë‹¤ë©´ New Relic ë„ì…ì„ ê²€í†  í•´ë³´ëŠ”ê²Œ ì¢‹ì„ ê²ƒ ê°™ë‹¤.**

</details>

<details>
<summary><strong>íŠ¸ë˜í”½ ì œì–´ë¥¼ ìœ„í•œ ëŒ€ê¸°ì—´ ê¸°ëŠ¥ ë„ì…</strong></summary>
    
### 1. ë°°ê²½
    
í˜„ì¬ ì‹œìŠ¤í…œì€ íŠ¹ì • ê¸°ëŠ¥(ì˜ˆ: í‹°ì¼“ ì˜ˆë§¤)ì„ ì¤‘ì‹¬ìœ¼ë¡œ **ë‹¨ì‹œê°„ì— ë§ì€ ì‚¬ìš©ìì˜ ìš”ì²­ì´ ì§‘ì¤‘ë  ê°€ëŠ¥ì„±**ì´ ì¡´ì¬í•©ë‹ˆë‹¤.
    
ì´ëŸ¬í•œ ìš”ì²­ ì§‘ì¤‘ì€ ì„œë²„ì˜ ì¼ì‹œì ì¸ ê³¼ë¶€í•˜, DB ì—°ê²° ìˆ˜ ì´ˆê³¼, ì£¼ìš” ê¸°ëŠ¥ì˜ ì§€ì—° ë˜ëŠ” ì‹¤íŒ¨ë¡œ ì´ì–´ì§ˆ ìˆ˜ ìˆìœ¼ë©°, ì‚¬ìš©ì ê²½í—˜ ì €í•˜ì™€ ì„œë¹„ìŠ¤ ì‹ ë¢°ë„ í•˜ë½ì˜ ì›ì¸ì´ ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    
íŠ¹íˆ ì´ë²¤íŠ¸ì„± ê¸°ëŠ¥ì€ íŠ¹ì„±ìƒ **ë™ì‹œë‹¤ë°œì ì¸ ìš”ì²­ íë¦„ì´ ë°œìƒí•˜ê¸° ì‰¬ì›Œ**, ì´ë¥¼ ì‚¬ì „ì— ì œì–´í•  ìˆ˜ ìˆëŠ” ê¸°ìˆ ì  ì¥ì¹˜ê°€ í•„ìš”í•˜ë‹¤ê³  íŒë‹¨í–ˆìŠµë‹ˆë‹¤.
    
ì´ì— ë”°ë¼, ìš”ì²­ì„ ì¼ì •ëŸ‰ì”© ìˆœì°¨ì ìœ¼ë¡œ ì²˜ë¦¬í•˜ì—¬ ì‹œìŠ¤í…œ ì•ˆì •ì„±ì„ í™•ë³´í•˜ê¸° ìœ„í•œ **ëŒ€ê¸°ì—´(Queue) ê¸°ëŠ¥** ë„ì…ì„ ê²€í† í•˜ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.
    
<br>
    
### 2. ìš”êµ¬ì‚¬í•­
    
- **ì„œë²„ ë³´í˜¸**: ê³¼ë„í•œ ë™ì‹œ ìš”ì²­ìœ¼ë¡œë¶€í„° DB ë° ì„œë²„ ë¦¬ì†ŒìŠ¤ë¥¼ ë³´í˜¸í•´ì•¼ í•¨
- **ìš”ì²­ ìˆœì„œ ë³´ì¥**: ë¨¼ì € ì˜¨ ìš”ì²­ì´ ë¨¼ì € ì²˜ë¦¬ë˜ëŠ” **FIFO(First-In-First-Out)** ë°©ì‹ í•„ìš”
    
<br>
    
### 3. ê³ ë ¤í•œ ëŒ€ì•ˆ
    
| **ë¹„êµ í•­ëª©** | **ìºì‹± ê¸°ë°˜ ì‘ë‹µ ì†ë„ í–¥ìƒ** | **ëŒ€ê¸°ì—´ ê¸°ë°˜ ìˆœì°¨ ì²˜ë¦¬** |
| --- | --- | --- |
| **ì ìš© ëª©ì ** | ì½ê¸° ìš”ì²­ì„ ë¹ ë¥´ê²Œ ì‘ë‹µ (ë¶€í•˜ ì™„í™”) | ì“°ê¸° ìš”ì²­ì„ ì œì–´í•˜ë©° ìˆœì°¨ ì²˜ë¦¬ |
| **ì ìš© ëŒ€ìƒ** | ë™ì¼í•œ ìš”ì²­ì´ ë°˜ë³µë˜ëŠ” **ì¡°íšŒì„± API** | ë‹¨ê±´ ì²˜ë¦¬ ë¹„ìš©ì´ ë†’ì€ **ë“±ë¡/ìˆ˜ì •/ì²˜ë¦¬ì„± API** |
| **ì‹œê°„ ë³µì¡ë„** | ë§¤ìš° ë‚®ìŒ (O(1) ì¡°íšŒ ê°€ëŠ¥) | O(1) ì‚½ì… + ì¼ì •í•œ ì†Œë¹„ ì£¼ê¸° í•„ìš” |
| **íŠ¸ë˜í”½ ì œì–´ ë°©ì‹** | ìš”ì²­ ìì²´ë¥¼ ì¤„ì„ (ìºì‹œ ì ì¤‘ ì‹œ) | ìš”ì²­ì„ íì— ë‹´ì•„ **ì§€ì—° ì²˜ë¦¬** |
| **ì‚¬ìš©ì ê²½í—˜** | âœ… ë¹ ë¥¸ ì‘ë‹µ |  "ëŒ€ê¸° ì¤‘" ê²½í—˜ ìœ ë„ í•„ìš” |
| **ê³¼ë¶€í•˜ ë°©ì§€ íš¨ê³¼** | âœ… Redis ì ì¤‘ë¥  ë†’ì„ìˆ˜ë¡ íš¨ê³¼ í¼ | âœ… ìš”ì²­ëŸ‰ì„ ë¶„ì‚°ì‹œì¼œ DB ë³´í˜¸ |
| **ì ìš© ë‚œì´ë„** | âœ… ìƒëŒ€ì ìœ¼ë¡œ ê°„ë‹¨ | âš ï¸ ë™ì‹œì„±, ìŠ¤ì¼€ì¤„ë§ ë“± ê³ ë ¤ì‚¬í•­ ë§ìŒ |
| **ë‹¨ì ** | âŒ ìµœì‹ ì„±ì´ ë–¨ì–´ì§ˆ ìˆ˜ ìˆìŒ | âŒ ëŒ€ê¸° ì‹œê°„ì´ ê¸¸ì–´ì§€ë©´ UX ì €í•˜ |
    
<br>
    
### 4. ê²°ì • ë° ê·¼ê±° - ëŒ€ê¸°ì—´ ë„ì…
    
**âœ… ì˜ˆë§¤ëŠ” ì…ë ¥ ì‘ì—…ì´ ë™ë°˜**
    
- ìºì‹œëŠ” íŠ¸ë˜í”½ ë¶€í•˜ë¥¼ ì¤„ì´ê¸° ìœ„í•œ íš¨ê³¼ì ì¸ ìˆ˜ë‹¨ì´ì§€ë§Œ, ê·¸ ëŒ€ìƒì€ ì£¼ë¡œ **ì½ê¸°(Read)** ìš”ì²­ì— êµ­í•œë¨
- ê·¸ëŸ¬ë‚˜ **ì¢Œì„ ì˜ˆë§¤ëŠ” ë‹¨ìˆœ ì¡°íšŒë¥¼ ë„˜ì–´ ì„œë²„ ìƒíƒœë¥¼ ë³€ê²½í•˜ëŠ” ì…ë ¥(Write) ì‘ì—…**ì´ í¬í•¨ë˜ë©°, ì´ ì…ë ¥ ìš”ì²­ ë˜í•œ **ê³¼ë„í•˜ê²Œ ëª°ë¦´ ê²½ìš° ì„œë²„ ê³¼ë¶€í•˜ë¥¼ ìœ ë°œ**
- íŠ¹íˆ ì˜ˆë§¤ íë¦„ì€ ë‹¨ìˆœíˆ â€œì¢Œì„ ì¡°íšŒ â†’ ì˜ˆë§¤ ìš”ì²­â€ì´ ì•„ë‹ˆë¼, ë§ì€ ì‚¬ìš©ìê°€ ë™ì‹œì— ì¡°íšŒë¥¼ ì‹œì‘í•˜ë©´ì„œ **ì…ë ¥ ì´ì „ ë‹¨ê³„ì—ì„œ ì´ë¯¸ ë¦¬ì†ŒìŠ¤ê°€ ê³ ê°ˆë˜ê¸° ì‹œì‘í•¨**
    
ë”°ë¼ì„œ ë‹¤ìŒê³¼ ê°™ì€ íë¦„ìœ¼ë¡œ íŠ¸ë˜í”½ì„ ì œì–´í•¨:
    
- ëŒ€ê¸°ì—´ â†’ ì¢Œì„ ì¡°íšŒ â†’ ì˜ˆë§¤ ìš”ì²­5. ëŒ€ê¸°ì—´ ì„¤ê³„ ë° êµ¬í˜„
    
<br>
    
### 5. ëŒ€ê¸°ì—´ êµ¬í˜„ ë°©ì‹
    
| ë¹„êµ í•­ëª© | Java ë‚´ë¶€ í (BlockingQueue ë“±) | Redis ê¸°ë°˜ í | ë©”ì‹œì§€ í ì‹œìŠ¤í…œ (Kafka, RabbitMQ) |
| --- | --- | --- | --- |
| ì ìš© ë‚œì´ë„ | ê°„ë‹¨ | ë¹„êµì  ê°„ë‹¨ | ì„¤ì • ë³µì¡, ì™¸ë¶€ ì‹œìŠ¤í…œ í•„ìš” |
| ë™ì‹œì„± ì²˜ë¦¬ | ë‹¨ì¼ ì¸ìŠ¤í„´ìŠ¤ ë‚´ì—ì„œë§Œ ê°€ëŠ¥ | ë¶„ì‚° í™˜ê²½ì—ì„œë„ ê°€ëŠ¥ | ë†’ì€ ìˆ˜ì¤€ì˜ ë³‘ë ¬/ë¹„ë™ê¸° ì²˜ë¦¬ |
| í™•ì¥ì„± | ì¸ìŠ¤í„´ìŠ¤ ë¡œì»¬ì— í•œì • | Redis í´ëŸ¬ìŠ¤í„°ë¡œ í™•ì¥ ê°€ëŠ¥ | ìˆ˜í‰ í™•ì¥ ìµœì í™” |
| ì§€ì†ì„± | ì„œë²„ ì¬ì‹œì‘ ì‹œ ì´ˆê¸°í™” | Redis ì„¤ì •ì— ë”°ë¼ ê°€ëŠ¥ | ë‚´êµ¬ì„± ë³´ì¥ (ë””ìŠ¤í¬ ê¸°ë°˜ ì €ì¥)ê²°ì • |
    
### **Redisê¸°ë°˜ í**
    
ëŒ€ê¸°ì—´ êµ¬í˜„ ë°©ì‹ìœ¼ë¡œ **Redis ê¸°ë°˜ í**ë¥¼ ì„ íƒ.
    
RedisëŠ” Java ë‚´ë¶€ íì— ë¹„í•´ **ë¶„ì‚° í™˜ê²½ì— ë” ì í•©í•˜ë©°**, Spring Bootì™€ì˜ ì—°ë™ë„ ê°„ë‹¨í•´ ì‹¤ì œ ì„œë¹„ìŠ¤ í™˜ê²½ì— ë¹ ë¥´ê²Œ ì ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    
ë˜í•œ ëŒ€ê¸°ì—´ì˜ ìˆœë²ˆ ì •ë³´ëŠ” **ê²°ì œë‚˜ íŠ¸ëœì­ì…˜ ì²˜ë¦¬ì²˜ëŸ¼ ê³ ì‹ ë¢° ë¡œê·¸ ë³´ê´€ì´ í•„ìš”í•œ ë°ì´í„°ê°€ ì•„ë‹Œ**, **ì¼ì‹œì ì¸ íŠ¸ë˜í”½ íë¦„ì„ ì œì–´í•˜ê¸° ìœ„í•œ ìš©ë„**ì´ë¯€ë¡œ, Kafkaë‚˜ RabbitMQ ê°™ì€ ë©”ì‹œì§€ ë¸Œë¡œì»¤ë¥¼ ë„ì…í•˜ëŠ” ê²ƒì€ **ë³µì¡ë„ì™€ ë¹„ìš© ì¸¡ë©´ì—ì„œ ì˜¤ë²„ì—”ì§€ë‹ˆì–´ë§ì— í•´ë‹¹í•œë‹¤ê³  íŒë‹¨**í•˜ì˜€ìŠµë‹ˆë‹¤.
    
<br>
    
### 6. ëŒ€ê¸°ì—´ ì„¤ê³„ ë° êµ¬í˜„
    
- 1. ëŒ€ê¸°ì—´ ì„¤ê³„ì™€ ë ˆë””ìŠ¤ ìë£Œêµ¬ì¡° ì„ íƒ
        
  ![image](https://github.com/user-attachments/assets/fcbf1875-2e7c-4e8f-a66f-4f84475453c8)
        
**ëŒ€ê¸°ì—´(WaitingQueue)** ê³¼ **ì‘ì—…ì—´(ProceedQueue)** ë‘ ë‹¨ê³„ë¡œ ë‚˜ëˆ„ì–´ ì„¤ê³„
        
### ì„¤ê³„ ê°œìš”
        
- ì‚¬ìš©ì ìš”ì²­ ì‹œ, HTTP í—¤ë”ì— ëŒ€ê¸°ì—´ í† í°(UUID)ì´ í¬í•¨ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸
- í† í°ì´ ì—†ëŠ” ê²½ìš°, Redis ZSetì„ ê¸°ë°˜ìœ¼ë¡œ ëŒ€ê¸°ì—´ì— ìƒˆ í† í°ì„ ë“±ë¡
- ì‚¬ìš©ìì—ê²ŒëŠ” **ëŒ€ê¸°ì—´ ìˆœë²ˆ** ì‘ë‹µ
- ë°±ê·¸ë¼ìš´ë“œ ìŠ¤ì¼€ì¤„ëŸ¬ê°€ Redis ZSetì—ì„œ ì•ìª½ í† í°ë“¤ì„ ì¼ì • ê°„ê²©ìœ¼ë¡œ êº¼ë‚´ ì‘ì—…ì—´ë¡œ ì´ë™
- ì‘ì—…ì—´ì— ì¡´ì¬í•˜ëŠ” í† í°ë§Œ ìš”ì²­ ì²˜ë¦¬ í—ˆìš©
- ì‚¬ìš©ìëŠ” pollingì„ í†µí•´ ì‘ì—…ì—´ ì§„ì… ì—¬ë¶€ í™•ì¸

<br>

### ëŒ€ê¸°ì—´ (**WaitingQueue**)
        
- Sorted Set(ZSet) ìë£Œêµ¬ì¡°ì‚¬ìš©
- **ì •ë ¬ëœ ìˆœì„œë¥¼ ìœ ì§€í•˜ë©´ì„œë„ ì‚½ì…/ì‚­ì œ/ì¡°íšŒê°€ ë¹ ë¦„**

<br>

### **ì‘ì—…ì—´(ProceedQueue)**
        
- String ìë£Œêµ¬ì¡° ì‚¬ìš©
- String Key ì¡´ì¬ ì—¬ë¶€ë¡œ ì²˜ë¦¬ ê°€ëŠ¥ ì—¬ë¶€ë¥¼ ë¹ ë¥´ê²Œ íŒë‹¨ O(1)
- ê°ê°ì˜ í† í°ì— TTL ì„¤ì •ì„ í†µí•´ **ì‹œê°„ ì´ˆê³¼ ìë™ ì œê±°**ê°€ëŠ¥
        
    - 2.  ëŒ€ê¸°ì—´(Waiting Queue)
        
        ```java
                @Service
        public class RedisWaitingQueueService implements WaitingQueueService {
        	private final ZSetOperations<String, String> waitingQueue;
        
        	public RedisWaitingQueueService(RedisTemplate<String, String> redisTemplate) {
        		waitingQueue = redisTemplate.opsForZSet();
        	}
        
        	//ëŒ€ê¸°ì—´ ì…ì¥ í›„ í† í° ë°˜í™˜
        	@Override
        	public String enterWaitingQueue() {
        		String token = UUID.randomUUID().toString();
        		long now = System.currentTimeMillis();
        		waitingQueue.addIfAbsent(QueueSystemConstants.WAITING_QUEUE_KEY, token, now);
        		return token;
        	}
        
        	//ëŒ€ê¸°ì—´ ìˆœì„œ ì¡°íšŒ
        	@Override
        	public long getOrder(String token) {
        		Long rank = waitingQueue.rank(QueueSystemConstants.WAITING_QUEUE_KEY, token);
        		return rank == null ? -1 : rank;
        	}
        
        	@Override
        	public void removeToken(String token) {
        		waitingQueue.remove(QueueSystemConstants.WAITING_QUEUE_KEY, token);
        	}
        }
        ```
        
    - 3.  ì‘ì—…ì—´(ProceedQueue)
        
        ```java
                @Component
        public class RedisProceedQueueServiceV2 implements ProceedQueueService {
        
        	private final ValueOperations<String, String> proceedList;
        	private final RedisTemplate<String, String> scriptRunner;
        	private final DefaultRedisScript<Long> moveWaitingToProceedV2;
        
        	public RedisProceedQueueServiceV2(RedisTemplate<String, String> redisTemplate, DefaultRedisScript<Long> moveWaitingToProceedScriptV2) {
        		this.proceedList = redisTemplate.opsForValue();
        		this.scriptRunner = redisTemplate;
        		this.moveWaitingToProceedV2 = moveWaitingToProceedScriptV2;
        	}
        	
        	@Override
        	public boolean isContains(String token) {
        		return proceedList.get(QueueSystemConstants.PROCEED_QUEUE_KEY+":"+ token) != null;
        	}
        
        	@Override
        	public void removeToken(String token) {
        		proceedList.getOperations().delete(QueueSystemConstants.PROCEED_QUEUE_KEY+":"+ token);
        	}
        
        	@Override
        	public void pullFromWaitingQueue(Long targetSize) {
        		scriptRunner.execute(moveWaitingToProceedV2,
        			List.of(QueueSystemConstants.WAITING_QUEUE_KEY, QueueSystemConstants.PROCEED_QUEUE_KEY),
        			String.valueOf(targetSize));
        	}
        
        }
        ```
        
    - 4.  ëŒ€ê¸°ì—´ê³¼ ì‘ì—…ì—´ì˜ ê¸°ëŠ¥ì„ í†µí•©í•´ì„œ íë¦„ ì œì–´
        
        ```java
        @Component
        public class QueueManager {
        	private final WaitingQueueService waitingQueueService;
        	private final ProceedQueueService proceedQueueService;
        
        	public QueueManager(WaitingQueueService waitingQueueService, @Qualifier("redisProceedQueueServiceV2") ProceedQueueService proceedQueueService) {
        		this.waitingQueueService = waitingQueueService;
        		this.proceedQueueService = proceedQueueService;
        	}
        	//ëŒ€ê¸°ì—´ ì…ì¥
        	public String enterWaitingQueue() {
        		return waitingQueueService.enterWaitingQueue();
        	}
        
        	//ëŒ€ê¸°ìˆœë²ˆ ì¡°íšŒ
        	public long getWaitingOrder(String token) {
        		long waitingOrder = waitingQueueService.getOrder(token);
        		boolean isProceed = proceedQueueService.isContains(token);
        		//ëŒ€ê¸°ì—´, ì‘ì—…ì—´ ì— ì¡´ì¬í•˜ì§€ì•Šìœ¼ë©´ ì˜ëª»ëœ í† í°
        		if(waitingOrder == -1 && !isProceed) {
        			log.warn(" í† í°ì´ ëŒ€ê¸°ì—´ / ì‘ì—…ì—´ì— ëª¨ë‘ ì¡´ì¬í•˜ì§€ì•ŠìŠµë‹ˆë‹¤ : {}", token);
        			throw new ServerException(INVALID_WAITING_TOKEN);
        		}
        		return waitingOrder;
        	}
        
        	//í•´ë‹¹ í† í°ì´ ì‘ì—…ì´ ê°€ëŠ¥í•œ ìƒíƒœì¸ì§€ ì¡°íšŒ
        	public boolean isAllowed(String token) {
        		return proceedQueueService.isContains(token);
        	}
        
        	public void removeTokenFromProceedQueue(String token) {
        		proceedQueueService.removeToken(token);
        	}
        
        	public void deleteTokenFromWaitingAndProceedQueue(String token) {
        		waitingQueueService.removeToken(token);
        		proceedQueueService.removeToken(token);
        	}
        
        	public long getExpectedWaitingOrder(long currentWaitingOrder) {
        		double v = QueueSystemConstants.PROCEED_QUEUE_TARGET_SIZE * 0.8;
        		return (long) Math.floor(currentWaitingOrder / v) + 1;
        	}
        
        	@Scheduled(fixedRate = 1000)
        	public void moveWaitingToProceedAtomicScheduled(){
        		proceedQueueService.pullFromWaitingQueue(QueueSystemConstants.PROCEED_QUEUE_TARGET_SIZE);
        	}
        }
        ```
        
  <br>
    
  ### 7.  ë„ì… í›„ í…ŒìŠ¤íŠ¸
    
    - í…ŒìŠ¤íŠ¸ ê°œìš”
        - Tool : k6
        - vuser : 1000, duration : 300s
        - ëŒ€ìƒ : /api/v1/games/${GAME_ID} ( ì˜ˆë§¤í•˜ê¸° ì „ì— ë°˜ë“œì‹œ ê±°ì³ì•¼í•˜ëŠ” api )
        - polling ë°©ì‹ / ê°„ê²© 1s
        - ìŠ¤ì¼€ì¤„ë§ ì‚¬ìš©ì—¬ë¶€ì—ê´€í•œ í…ŒìŠ¤íŠ¸
            - ëŒ€ê¸°ì—´í† í°ì„ ì‘ì—…ì—´ë¡œ ì´ë™ì‹œí‚¤ëŠ” ë©”ì„œë“œë¥¼ ìŠ¤ì¼€ì¤„ë§ì„ í†µí•´ ì´ë™ì‹œí‚¤ëŠ”ê²ƒê³¼
            - polling ìš”ì²­ë§ˆë‹¤ ì´ë™ì‹œí‚¤ëŠ” ë°©ì‹ ë¹„êµ
        - í…ŒìŠ¤íŠ¸ëŠ” í•­ëª©ë³„ë¡œ 3ë²ˆì”© ì§„í–‰
        
        ```java
        import http from 'k6/http';
        import { sleep } from 'k6';
        import { Counter } from 'k6/metrics';
        
        export const successCount = new Counter('success_count');
        
        const BASE_URL = 'http://localhost:8080';
        const GAME_ID = 1;
        
        const tokenMap = {};
        
        export const options = {
          vus: 1000,
          duration: '300s',
        };
        
        export default function () {
          const vu = __VU;
          let token = tokenMap[vu];
        
          const headers = token ? { 'waiting-token': token } : {};
          const res = http.get(`${BASE_URL}/api/v1/games/${GAME_ID}`, { headers });
        
          if (res.status === 200) {
            successCount.add(1);
            console.log(`[VU ${vu}] âœ… ì…ì¥ ì„±ê³µ`);
            tokenMap[vu] = null;
          } else if (res.status === 202) {
            try {
              const body = JSON.parse(res.body);
              if (body.token && !token) {
                tokenMap[vu] = body.token;
                console.log(`[VU ${vu}] ì‹ ê·œ token ë°œê¸‰: ${body.token}`);
              } else if (body.order !== undefined) {
                console.log(`[VU ${vu}] ëŒ€ê¸° ì¤‘... ìˆœë²ˆ: ${body.order}`);
              }
            } catch (_) {
              console.error(`[VU ${vu}] ì‘ë‹µ íŒŒì‹± ì‹¤íŒ¨`);
            }
          } else {
            console.error(`[VU ${vu}] âŒ ì‹¤íŒ¨ ì‘ë‹µ: ${res.status}`);
          }
        
          sleep(1);
        }
        ```
        
    - ëŒ€ê¸°ì—´X
        
        ```java
               /\      Grafana   /â€¾â€¾/
            /\  /  \     |\  __   /  /
           /  \/    \    | |/ /  /   â€¾â€¾\
          /          \   |   (  |  (â€¾)  |
         / __________ \  |_|\_\  \_____/
        
             execution: local
                script: stress.js
                output: -
        
             scenarios: (100.00%) 1 scenario, 1000 max VUs, 5m30s max duration (incl. graceful stop):
                      * default: 1000 looping VUs for 5m0s (gracefulStop: 30s
        
          â–ˆ TOTAL RESULTS
        
            CUSTOM
            success_count...........................................................: 28184  90.576499/s
        
            HTTP
            http_req_duration.......................................................: avg=9.83s  min=121.39ms med=10.04s max=12.48s p(90)=10.2s p(95)=10.25s
              { expected_response:true }............................................: avg=9.83s  min=121.39ms med=10.04s max=12.48s p(90)=10.2s p(95)=10.25s
            http_req_failed.........................................................: 0.00%  0 out of 28184
            http_reqs...............................................................: 28184  90.576499/s
        
            EXECUTION
            iteration_duration......................................................: avg=10.84s min=1.14s    med=11.04s max=13.48s p(90)=11.2s p(95)=11.25s
            iterations..............................................................: 28184  90.576499/s
            vus.....................................................................: 19     min=19         max=1000
            vus_max.................................................................: 1000   min=1000       max=1000
        
            NETWORK
            data_received...........................................................: 15 MB  48 kB/s
            data_sent...............................................................: 2.8 MB 9.0 kB/s
        ```
        
        | ì§€í‘œ | ê°’ |
        | --- | --- |
        | ì´ ìš”ì²­ ìˆ˜ | 28,184 |
        | ì„±ê³µ ì‘ë‹µ ìˆ˜ (`success_count`) | 28,184 |
        | ìš”ì²­ ì‹¤íŒ¨ìœ¨ | **0.00% (0/28,184)** |
        | í‰ê·  ì‘ë‹µ ì‹œê°„ | **9.83ì´ˆ** |
        | ìµœì†Œ ì‘ë‹µ ì‹œê°„ | 121.39 ms |
        | ì¤‘ê°„ê°’ (median) | 10.04ì´ˆ |
        | ìµœëŒ€ | 12.48ì´ˆ |
        | 90th Percentile | 10.2ì´ˆ |
        | 95th Percentile | 10.25ì´ˆ |
        | í‰ê·  ìš”ì²­ ì†ë„ | 90.57 req/s |
    - ëŒ€ê¸°ì—´O, ì‘ì—…ì—´ í† í° ì´ë™ ìˆ˜ 50
        
        ```java
                /\      Grafana   /â€¾â€¾/
            /\  /  \     |\  __   /  /
           /  \/    \    | |/ /  /   â€¾â€¾\
          /          \   |   (  |  (â€¾)  |
         / __________ \  |_|\_\  \_____/
        
             execution: local
                script: stress.js
                output: -
        
             scenarios: (100.00%) 1 scenario, 1000 max VUs, 5m30s max duration (incl. graceful stop):
                      * default: 1000 looping VUs for 5m0s (gracefulStop: 30s)
        
          â–ˆ TOTAL RESULTS
        
            CUSTOM
            success_count...........................................................: 15646  51.96693/s
        
            HTTP
            http_req_duration.......................................................: avg=15.09ms min=1.05ms med=6.34ms max=758.58ms p(90)=17.43ms p(95)=81.94m
              { expected_response:true }............................................: avg=15.09ms min=1.05ms med=6.34ms max=758.58ms p(90)=17.43ms p(95)=81.94m
            http_req_failed.........................................................: 0.00%  0 out of 295217
            http_reqs...............................................................: 295217 980.539513/s
        
            EXECUTION
            iteration_duration......................................................: avg=1.01s   min=1s     med=1s     max=2.52s    p(90)=1.01s   p(95)=1.08s
            iterations..............................................................: 295217 980.539513/s
            vus.....................................................................: 15     min=15          max=1000
            vus_max.................................................................: 1000   min=1000        max=1000
        
            NETWORK
            data_received...........................................................: 137 MB 454 kB/s
            data_sent...............................................................: 44 MB  146 kB/s
        
        running (5m01.1s), 0000/1000 VUs, 295217 complete and 0 interrupted iterations
        default âœ“ [======================================] 1000 VUs  5m0s
        ```
        
        | í•­ëª© | ê°’ |
        | --- | --- |
        | **ì´ ìš”ì²­ ìˆ˜** | 295,217 |
        | ì„±ê³µ ì‘ë‹µ ìˆ˜ (`success_count`) | 15646 |
        | **ìš”ì²­ ì‹¤íŒ¨ìœ¨** | 0.00% (0/295,217) |
        | **í‰ê·  ì‘ë‹µ ì‹œê°„** | 15.09 ms |
        | **ìµœì†Œ ì‘ë‹µ ì‹œê°„** | 1.05 ms |
        | **ì¤‘ê°„ê°’ (median)** | 6.34 ms |
        | **ìµœëŒ€ ì‘ë‹µ ì‹œê°„** | 758.58 ms |
        | **90th percentile** | 17.43 ms |
        | **95th percentile** | 81.94 ms |
        | í‰ê·  ìš”ì²­ ì†ë„ | 980.54 req/s |
    - ëŒ€ê¸°ì—´O, ì‘ì—…ì—´ í† í° ì´ë™ ìˆ˜ 100
        
        ```java
        
                 /\      Grafana   /â€¾â€¾/
            /\  /  \     |\  __   /  /
           /  \/    \    | |/ /  /   â€¾â€¾\
          /          \   |   (  |  (â€¾)  |
         / __________ \  |_|\_\  \_____/
        
             execution: local
                script: stress.js
                output: -
        
             scenarios: (100.00%) 1 scenario, 1000 max VUs, 5m30s max duration (incl. graceful stop):
                      * default: 1000 looping VUs for 5m0s (gracefulStop: 30s)
        
          â–ˆ TOTAL RESULTS
        
            CUSTOM
            success_count...........................................................: 27291  90.596587/s
        
            HTTP
            http_req_duration.......................................................: avg=41.95ms min=1.49ms med=6.33ms max=2.18s p(90)=34.51ms p(95)=354.91ms
              { expected_response:true }............................................: avg=41.95ms min=1.49ms med=6.33ms max=2.18s p(90)=34.51ms p(95)=354.91ms
            http_req_failed.........................................................: 0.00%  0 out of 287962
            http_reqs...............................................................: 287962 955.933255/s
        
            EXECUTION
            iteration_duration......................................................: avg=1.04s   min=1s     med=1s     max=3.18s p(90)=1.04s   p(95)=1.36s
            iterations..............................................................: 287962 955.933255/s
            vus.....................................................................: 69     min=69          max=1000
            vus_max.................................................................: 1000   min=1000        max=1000
        
            NETWORK
            data_received...........................................................: 134 MB 446 kB/s
            data_sent...............................................................: 42 MB  140 kB/s
        
        running (5m01.2s), 0000/1000 VUs, 287962 complete and 0 interrupted iterations
        default âœ“ [======================================] 1000 VUs  5m0s
        ```
        
        | ì§€í‘œ | ê°’ |
        | --- | --- |
        | ì´ ìš”ì²­ ìˆ˜ | 287,962 |
        | ì„±ê³µ ì‘ë‹µ ìˆ˜ (`success_count`) | **27,291** |
        | ìš”ì²­ ì‹¤íŒ¨ìœ¨ | 0.00% (0/287,962) |
        | í‰ê·  ì‘ë‹µ ì‹œê°„ | 41.95 ms |
        | ìµœì†Œ ì‘ë‹µ ì‹œê°„ | 1.49 ms |
        | ì¤‘ê°„ê°’ (median) | 6.33 ms |
        | ìµœëŒ€ | 2.18 s |
        | 90th Percentile | 34.51 ms |
        | 95th Percentile | 354.91 ms |
        | í‰ê·  ìš”ì²­ ì†ë„ | 955.93 req/s |
    - ëŒ€ê¸°ì—´O,  pollingë§ˆë‹¤ í† í° ì´ë™ ë°©ì‹
        
        ```java
        
                 /\      Grafana   /â€¾â€¾/
            /\  /  \     |\  __   /  /
           /  \/    \    | |/ /  /   â€¾â€¾\
          /          \   |   (  |  (â€¾)  |
         / __________ \  |_|\_\  \_____/
        
             execution: local
                script: stress.js
                output: -
        
             scenarios: (100.00%) 1 scenario, 1000 max VUs, 5m30s max duration (incl. graceful stop):
                      * default: 1000 looping VUs for 5m0s (gracefulStop: 30s)
        
          â–ˆ TOTAL RESULTS
        
            CUSTOM
            success_count...........................................................: 27709  91.785119/s
        
            HTTP
            http_req_duration.......................................................: avg=77.6ms min=3.21ms med=10.82ms max=2.26s p(90)=97.18ms p(95)=660.47ms
              { expected_response:true }............................................: avg=77.6ms min=3.21ms med=10.82ms max=2.26s p(90)=97.18ms p(95)=660.47ms
            http_req_failed.........................................................: 0.00%  0 out of 278199
            http_reqs...............................................................: 278199 921.524712/s
        
            EXECUTION
            iteration_duration......................................................: avg=1.08s  min=1s     med=1.01s   max=3.26s p(90)=1.1s    p(95)=1.67s
            iterations..............................................................: 278199 921.524712/s
            vus.....................................................................: 150    min=150         max=1000
            vus_max.................................................................: 1000   min=1000        max=1000
        
            NETWORK
            data_received...........................................................: 130 MB 430 kB/s
            data_sent...............................................................: 41 MB  135 kB/s
        ```
        
        | ì§€í‘œ | ê°’ |
        | --- | --- |
        | ì´ ìš”ì²­ ìˆ˜ | 278,199 |
        | ì„±ê³µ ì‘ë‹µ ìˆ˜ (`success_count`) | 27,709 |
        | ìš”ì²­ ì‹¤íŒ¨ìœ¨ | **0.00%** (0/278,199) |
        | í‰ê·  | 77.6 ms |
        | ìµœì†Œ | 3.21 ms |
        | ì¤‘ê°„ê°’ (median) | 10.82 ms |
        | ìµœëŒ€ | 2.26 s |
        | 90th Percentile | 97.18 ms |
        | 95th Percentile | 660.47 ms |
        | í‰ê·  ìš”ì²­ ì†ë„ | 921.52 req/s |
        
    - ìµœì¢… ê²°ë¡ 
        1. redis cpu ì ìœ ìœ¨
            1. polling ë§ˆë‹¤ - 19.13 ~ 24.60 %
            2. ìŠ¤ì¼€ì¤„ë§ (500ms) :  11 ~13.7%    â€”  44% íš¨ìœ¨ ê°œì„ 
        2. ëŒ€ê¸°ì—´ ì ìš© ì—¬ë¶€
            1. rps
                1. ëŒ€ê¸°ì—´ ì ìš© : 920 ~ 980 
                2. ëŒ€ê¸°ì—´ X : 98
                3. ëŒ€ê¸°ë²ˆí˜¸ ë°œê¸‰ì— ì˜í•œ rps ë»¥íŠ€ê¸°  
                4. ë‹¤ë§Œ, ë§¤ìš”ì²­ë§ˆë‹¤ ë¹ ë¥¸ì‘ë‹µì„ í†µí•œ ì‚¬ìš©ìê²½í—˜ ê°œì„  9ì´ˆ â†’ 0.3ì´ˆ ì´ë‚´ 97%ì´ìƒ ê°œì„ 
        3. ë‹¤ë¥¸ ì„œë¹„ìŠ¤ ì˜í–¥ ì—¬ë¶€
            1. ë¶€í•˜í…ŒìŠ¤íŠ¸ ë„ì¤‘ ë‹¤ë¥¸ apië¥¼ í˜¸ì¶œí–ˆì„ë•Œ ì‘ë‹µì‹œê°„ (Insomnia ì‚¬ìš©)
                1. ëŒ€ê¸°ì—´ ì ìš© : ëŒ€ë¶€ë¶„ì˜ ìš”ì²­ì´ 300ms ì´ë‚´ì— ì‘ë‹µ
                2. ëŒ€ê¸°ì—´ X : 9ì´ˆ ì´ìƒ ì§€ì—°
        4. ì„±ê³µ ì‘ë‹µ ìˆ˜(ëŒ€ê¸° ìˆœë²ˆX, apiì˜ ì›ë˜ì‘ë‹µ)
            1. ëŒ€ê¸°ì—´ì„ ì ìš©í•˜ì§€ ì•Šì€ ê²½ìš°ì— ì„±ê³µ ì‘ë‹µ ìˆ˜ê°€ ê°€ì¥ í¼
            2. ëŒ€ê¸°ì—´ì„ ì ìš©í–ˆì„ê²½ìš° ì‘ì—…ì—´ì˜ ìš©ëŸ‰ê³¼ ì„±ê³µ ì‘ë‹µ ìˆ˜ ë¹„ë¡€í•˜ì—¬ ì¦ê°€
                1. ë‹¤ë§Œ, ìš©ëŸ‰ì´ í´ìˆ˜ë¡ ì¼ë¶€ ì‘ë‹µì´ íŠ€ëŠ” í˜„ìƒ ë°œìƒ
                2. pending ìƒíƒœì˜ db connection ë˜í•œ í¬ê²Œ ì¦ê°€
    
<br>
    
### 8. í–¥í›„ ê³ ë ¤ ì‚¬í•­
    
**ë³µêµ¬ ì „ëµ ìˆ˜ë¦½**
    
- Redis ë‹¤ìš´ ì‹œ ëŒ€ê¸°ì—´ ì‹œìŠ¤í…œ ì „ì²´ ë§ˆë¹„ ê°€ëŠ¥ â†’ í´ëŸ¬ìŠ¤í„° êµ¬ì„± or ëŒ€ì²´ ì „ëµ í•„ìš”
- í† í°ì„ íŒŒì¼/DB ë°±ì—…í•´ ì¼ì‹œ ë³µêµ¬ ê°€ëŠ¥í•˜ë„ë¡ ì²˜ë¦¬ ê³ ë ¤

</details>

<details>
<summary><strong>ì•…ì„± ìœ ì €ì™€ ë´‡ ëŒ€ì²˜ ë°©ë²• ì„ íƒ</strong></summary>
    
### 1. ë°°ê²½
    
- ëª¨ë‹ˆí„°ë§ì„ êµ¬í˜„í•˜ë©´ì„œ ë§Œì•½ í•œ ìœ ì €ê°€ ì•…ì˜ì ìœ¼ë¡œ ê³¼ë„í•œ ìš”ì²­ì„ ë³´ë‚´ ê³µê²©ì„ í•˜ëŠ” ê²½ìš°ì™€(ex. DDos), ì•…ì„± ë´‡ ë“¤ì´ ê³„ì •ì„ ë§ˆêµ¬ì¡ì´ë¡œ ìƒì„±í•˜ëŠ” ê²½ìš°ì— ëŒ€í•´ ìƒê°í•´ë´¤ë‹¤.
- ê³¼ë„í•œ ìš”ì²­ì„ ë§‰ëŠ” Rate Limiter ì•Œê³ ë¦¬ì¦˜ê³¼ ì•…ì„± ë´‡ì„ ë§‰ëŠ” google reCAPTCHAë¥¼ ë„ì…í•˜ë„ë¡ ê²°ì •í–ˆë‹¤.
    
<br>
    
### 2. ìš”êµ¬ì‚¬í•­
    
- **ë§ì€ ë°˜ë³µ ìš”ì²­ ì°¨ë‹¨** : í•œ ìœ ì €ê°€ í•œ ìš”ì²­ì„ ë¹ ë¥´ê²Œ ë§ì´ ìš”ì²­í•  ë•Œ ì°¨ë‹¨
- **ì•…ì„± ë´‡ ì°¨ë‹¨** : ë´‡ì— ì˜í•œ ë¡œê·¸ì¸, íšŒì›ê°€ì… ì°¨ë‹¨
    
<br>
    
### 3. ì£¼ìš” ê¸°ëŠ¥
    
- **Rate Limiter**
  - **ê³¼ë„í•œ ìš”ì²­ì„ ì œí•œí•˜ê³  ì œì–´í•˜ê¸° ë•Œë¬¸ì— DDos ê°™ì€ ê³µê²©ì„ ë§‰ì•„ì¤€ë‹¤.**
  - **ìµœëŒ€ í˜¸ì¶œ ìˆ˜ë¥¼ ì œí•œí•˜ê¸° ë•Œë¬¸ì— ì´ í˜¸ì¶œì— ëŒ€í•œ ì˜ˆìƒì´ ê°€ëŠ¥í•˜ë©°, ì„œë²„ì— ë¬´ë¦¬ê°€ ê°€ì§€ ì•ŠëŠ” ì„ ìœ¼ë¡œ ì œí•œ ê¸°ì¤€ì„ ì„¤ì •í•˜ê¸° ë•Œë¬¸ì— ì„œë²„ì˜ ì•ˆì •ì ì¸ ê´€ë¦¬ê°€ ê°€ëŠ¥í•˜ë‹¤.**
  - **ìš”ì²­ì—ì„œ ê¸ˆì•¡ì ì¸ ë¶€ë‹´ì´ ì»¤ì§ˆ ìˆ˜ ìˆëŠ”ë°, Rate Limitì„ ì„¤ì •í•¨ìœ¼ë¡œì¨ ë¹„ìš©ì— ëŒ€í•œ ì˜ˆìƒì´ ê°€ëŠ¥í•˜ê³ , ë¹„ìš©ì„ ì ˆê°í•  ìˆ˜ ìˆë‹¤.**

<br>

- **google reCAPTCHA**
  - **ë‹¤ì–‘í•œ ìš”ì†Œë¥¼ ë¶„ì„í•˜ì—¬ ì‚¬ìš©ìê°€ ë´‡ì¼ í™•ë¥ ì„ í‰ê°€í•˜ê³  ì´ì— ë”°ë¼ ì‘ë‹µì„ ì¡°ì •í•œë‹¤.**
  - **ì •êµí•œ ê¸°ìˆ ì„ ì‚¬ìš©í•´ ì‚¬ëŒê³¼ ë´‡ì„ êµ¬ë¶„í•˜ì—¬ ì •í™•í•˜ê²Œ ì‹ë³„í•œë‹¤.**
  - **ë¨¸ì‹ ëŸ¬ë‹ì„ í™œìš©í•˜ì—¬ ë´‡ ê°ì§€ ì •í™•ë„ë¥¼ ì§€ì†ì ìœ¼ë¡œ ê°œì„ í•˜ê³  ìƒˆë¡œìš´ ìœ„í˜‘ì— ì ì‘í•œë‹¤.**
  - **ì¡°ì • ê°€ëŠ¥í•œ ìœ„í—˜ ë¶„ì„ ì—”ì§„ì„ ì œê³µí•˜ì—¬ ìë™í™” ëœ ì†Œí”„íŠ¸ì›¨ì–´ë¡œë¶€í„° ë³´í˜¸í•˜ê³  ì¡°ì§ì˜ ì›¹ì‚¬ì´íŠ¸ ë° ëª¨ë°”ì¼ ì•± ë‚´ì—ì„œ ì•…ì˜ì ì¸ í™œë™ì„ ì €ì§€í•œë‹¤.**
    
<br>
    
### 4. ê²°ê³¼ ì´ë¯¸ì§€
    
- **Rate Limiter**

  - ë¡œê·¸ì¸ ìš”ì²­ (1~2)

    ![image](https://github.com/user-attachments/assets/ace46885-3a9a-4690-98d5-0787e778562d)

  - ë¡œê·¸ì¸ ìš”ì²­ (3~5)

    ![image](https://github.com/user-attachments/assets/238266dd-b138-4257-a830-b56a5efa6367)

- **google reCAPTCHA**

  - ë¡œë´‡ì´ ì•„ë‹™ë‹ˆë‹¤ ë²„íŠ¼ ì•ˆ ëˆ„ë¥¼ ì‹œ

   ![image](https://github.com/user-attachments/assets/697a3b7d-b69b-4897-81dd-3a07f716f0a6)

  - ë²„íŠ¼ ëˆ„ë¥¼ ì‹œ

    ![image](https://github.com/user-attachments/assets/44afce8a-2362-4894-9373-b0437ea43371)

<br>
    
### 5. ì½”ë“œ
    
- **Rate Limiter**
  - **KeyResolverë¡œ ìœ ì €ì˜ Addressë¥¼ ê°€ì ¸ì˜´**
            
    ```java
    @Bean
    public KeyResolver ipKeyResolver() {
      return exchange ->
          Mono.just(Objects.requireNonNull(exchange.getRequest()
              .getRemoteAddress())
          .getAddress()
          .getHostAddress());
    }
    ```
            
  - **Gatewayì˜ ymlì—ì„œ redis tokenìœ¼ë¡œ í•´ë‹¹ ìœ ì €ì˜ ìš”ì²­ ìˆ˜ í™•ì¸ (ì¼ë¶€ë¶„)**
            
    ```java
    filters:
    - name: RequestRateLimiter
      args:
        keyResolver: "#{@ipKeyResolver}"
        redis-rate-limiter.replenishRate: 1   # ì´ˆë‹¹ ìµœëŒ€ 1 í† í° ìƒì„±
        redis-rate-limiter.burstCapacity: 2   # 2 í† í°ì‹œ ë²„ìŠ¤íŠ¸
    ```
            
- **google reCAPTCHA**
  - **reCAPTCHA í† í°ì´ ìˆëŠ”ì§€ ê²€ì¦ (ë²„íŠ¼ì„ ëˆŒë €ëŠ”ì§€)**
            
    ```java
            @Service
            public class ReCaptchaService {
            	
            	private final WebClient webClient;
            	private final String secretKey;
            	
            	public ReCaptchaService(
            		WebClient.Builder builder,
            		@Value("${recaptcha.verify.url}") String verifyUrl,
            		@Value("${recaptcha.secret.key}") String secretKey
            	) {
            		this.webClient = builder.baseUrl(verifyUrl).build();
            		this.secretKey = secretKey;
            	}
            	
            	public boolean isValid(String token) {
            		if (token == null || token.isEmpty()) {
            			return false;
            		}
            		
            		RecaptchaResponse response = webClient.get()
            			.uri(uriBuilder -> uriBuilder
            				.queryParam("secret", secretKey)
            				.queryParam("response", token)
            				.build())
            			.retrieve()
            			.bodyToMono(RecaptchaResponse.class)
            			.block();
            		
            		return response != null && response.isSuccess();
            	}
            }
    ```

 <br>
    
### 6. í–¥í›„ ê³ ë ¤ ì‚¬í•­
    
- **reCAPTCHA v3 ë²„ì „ ì‚¬ìš©**
- **Rate Limiter ê±¸ì–´ì¤„ APIë“¤ ê³ ë ¤**

</details>

<details>
<summary><strong>ë°ì´í„° ì¡°íšŒì—ì„œì˜ ë°©ì‹ ì„ íƒ</strong></summary>
    
### 1. ë°°ê²½
    
ê²½ë§¤ ë„ë©”ì¸ì—ì„œëŠ” í•˜ë‚˜ì˜ ê²½ë§¤ê°€ í‹°ì¼“, ì¢Œì„, ê²°ì œ ì •ë³´ ë“± ì—¬ëŸ¬ í…Œì´ë¸”ê³¼ ì¡°ì¸ì„ í†µí•´ ìƒì„¸ ì •ë³´ë¥¼ êµ¬ì„±í•´ì•¼ í•˜ë©°, ì •ë ¬ ì¡°ê±´(ì˜ˆ: ìƒì„±ì¼ ê¸°ì¤€ ìµœì‹ ìˆœ)ì— ë”°ë¼ ì„±ëŠ¥ ì´ìŠˆê°€ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    
íŠ¹íˆ **MSA í™˜ê²½ì—ì„œëŠ” ë‹¨ì¼ ëª¨ë†€ë¦¬ì‹ ì„œë²„ êµ¬ì¡°ë³´ë‹¤ ìš”ì²­/ì‘ë‹µ ê³¼ì •ì—ì„œ ë„¤íŠ¸ì›Œí¬ ì˜¤ë²„í—¤ë“œê°€ ì¶”ê°€ë˜ê³ **, ì„œë¹„ìŠ¤ ê°„ í†µì‹  ë° ë°ì´í„° í˜¸ì¶œ ì‹œì—ë„ ë” ë§ì€ ë¦¬ì†ŒìŠ¤ê°€ ì†Œëª¨ë©ë‹ˆë‹¤. ì´ëŸ¬í•œ êµ¬ì¡°ì—ì„œëŠ” ë™ì¼í•œ ê¸°ëŠ¥ì´ë¼ë„ ë” ë†’ì€ íš¨ìœ¨ì„±ê³¼ ìµœì í™”ê°€ í•„ìˆ˜ì…ë‹ˆë‹¤.
    
ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ **ë°˜ì •ê·œí™”(AuctionTicketInfo í…Œì´ë¸” ë¶„ë¦¬)** ê¸°ë²•ì„ ë„ì…í•˜ì—¬, ì¡°íšŒìš© ë°ì´í„°ë¥¼ ì‚¬ì „ì— êµ¬ì„±í•´ë†“ê³  ì¡°ì¸ ì—†ì´ ë¹ ë¥´ê²Œ ì¡°íšŒí•  ìˆ˜ ìˆë„ë¡ êµ¬ì¡°ë¥¼ ë³€ê²½í•˜ì˜€ìŠµë‹ˆë‹¤.
    
<br>
    
### 2. ìš”êµ¬ì‚¬í•­
    
- ê²½ë§¤ ìƒì„¸ì •ë³´ ì¡°íšŒëŠ” í˜ì´ì§€ë³„ë¡œ ëŒ€ëŸ‰ í˜¸ì¶œë  ìˆ˜ ìˆìœ¼ë¯€ë¡œ, ë‹¤ìŒ ì¡°ê±´ì„ ë§Œì¡±í•˜ëŠ” êµ¬ì¡°ê°€ í•„ìš”í•©ë‹ˆë‹¤:
  - ìµœì‹  ìƒì„±ì¼ ê¸°ì¤€ ì •ë ¬
  - ì¢Œì„ ìˆ˜, ì—°ì„ ì—¬ë¶€, ê²½ê¸° íŒ€ ë“±ì„ ê¸°ì¤€ìœ¼ë¡œ ì¡°ê±´ ê²€ìƒ‰
  - ëŒ€ëŸ‰ íŠ¸ë˜í”½ ì‹œ ë¹ ë¥¸ ì¡°íšŒ ë³´ì¥
    
<br>
    
### 3. ì‹¤í—˜ ê°œìš” ë° ë¹„êµ ê¸°ì¤€
    
| **í•­ëª©** | **ì •ê·œí™” ì¡°íšŒ ë°©ì‹** | **ë°˜ì •ê·œí™” ì¡°íšŒ ë°©ì‹** |
| --- | --- | --- |
| **ì¡°íšŒ ë°©ì‹** | ê° í…Œì´ë¸”ì„ ì¡°ì¸ í›„ ì‹¤ì‹œê°„ ê³„ì‚° | AuctionTicketInfo í…Œì´ë¸”ë¡œ ìºì‹±ëœ ì •ë³´ë§Œ ì¡°íšŒ |
| **ì¡°ì¸ ìˆ˜** | ìµœëŒ€ 5ê°œ (Game, Ticket, Seat, Section, Payment ë“±) | 2ê°œ (Auction, AuctionTicketInfo) |
| **ì ìš© ê¸°ìˆ ** | JPQL + N+1 íŒ¨ì¹˜ ë°©ì§€ìš© fetch join | QueryDSL ë‹¨ì¼ ì¡°ì¸ |
    
**ì¸¡ì • í•­ëª©:**
    
- ì „ì²´ ì¡°íšŒ ì‹œê°„
- ì‹¤í–‰ëœ SQL ì¿¼ë¦¬ ìˆ˜
- SQL ìµœëŒ€ ì‹¤í–‰ ì‹œê°„
- í˜ì´ì§€ ì‚¬ì´ì¦ˆ ë° ì „ì²´ ë°ì´í„° ìˆ˜ ì¦ê°€ì— ë”°ë¥¸ ì˜í–¥ë„
    
<br>
    
### 4. ì‹¤í—˜ í™˜ê²½
    
- í…ŒìŠ¤íŠ¸ ë°ì´í„°: 1,000 ~ 100,000ê±´ (Auction ê¸°ì¤€)
- í˜ì´ì§€ ì‚¬ì´ì¦ˆ: 10, 100, 1000
- í…ŒìŠ¤íŠ¸ ë°©ì‹: `@SpringBootTest` ê¸°ë°˜ í†µí•© í…ŒìŠ¤íŠ¸
- Hibernate Statistics ì‚¬ìš©
- ê° í…ŒìŠ¤íŠ¸ëŠ” `flush`/`clear`ë¡œ DB ìƒíƒœ ì´ˆê¸°í™” í›„ ìˆ˜í–‰
    
<br>
    
### 5. í…ŒìŠ¤íŠ¸ ê²°ê³¼ ìš”ì•½
    
| ë°ì´í„° ìˆ˜ | í˜ì´ì§€ ì‚¬ì´ì¦ˆ | ë°˜ì •ê·œí™” ì‹¤í–‰ì‹œê°„ (ms) | ì •ê·œí™” ì‹¤í–‰ì‹œê°„ (ms) | ì†ë„ ê°œì„ ìœ¨ |
| --- | --- | --- | --- | --- |
| 1,000 | 10 | 30.3 | 88.4 | **65.7%** |
| 1,000 | 100 | 55.1 | 387.6 | **85.8%** |
| 1,000 | 1000 | 147.3 | 5286.4 | **97.2%** |
| 10,000 | 10 | 131.1 | 881.9 | **85.1%** |
| 10,000 | 100 | 155.2 | 1337.3 | **88.4%** |
| 10,000 | 1000 | 252.0 | 7802.8 | **96.8%** |
| 100,000 | 10 | 610.3 | 2110.9 | **71.1%** |
| 100,000 | 100 | 655.8 | 2323.4 | **71.8%** |
| 100,000 | 1000 | 728.9 | 6843.7 | **89.3%** |
    
<br>
    
### 6. ì‹œê°í™” ê²°ê³¼ ìš”ì•½
    
  ![image](https://github.com/user-attachments/assets/f48e92ec-042d-4430-b43d-520c440f370d)
    
- **[ë°˜ì •ê·œí™” vs ì •ê·œí™” ì¡°íšŒ ì†ë„ ê·¸ë˜í”„]**: í˜ì´ì§€ê°€ ì»¤ì§ˆìˆ˜ë¡ ì°¨ì´ê°€ ì‹¬í™”ë¨
- **[ì¡°íšŒ ì„±ëŠ¥ ì ˆê° ë¹„ìœ¨]**: ìµœëŒ€ 97%ê¹Œì§€ ì„±ëŠ¥ ê°œì„ 
- **[ì´ SQL ì‹¤í–‰ ì‹œê°„]**: ì •ê·œí™” ë°©ì‹ì—ì„œ ì¿¼ë¦¬ ê±´ìˆ˜ê°€ ë§ìŒì—ë„ ì‹¤í–‰ì‹œê°„ì€ ì§§ìŒ (ë‹¨, ì´í•©ì€ ë†’ìŒ)
- **[ì¿¼ë¦¬ ìˆ˜]**: ë°˜ì •ê·œí™”ëŠ” 2~3ê°œë¡œ ê³ ì •, ì •ê·œí™”ëŠ” ìµœëŒ€ 2000ê±´ ì´ìƒ
- **[ì¿¼ë¦¬ë‹¹ í‰ê·  ì‹¤í–‰ ì‹œê°„]**: ì •ê·œí™”ëŠ” ì§§ì§€ë§Œ ì´ ìˆ˜ê°€ ë§ìŒ
    
<br>
    
### 7. ë¶„ì„
    
- **ë°˜ì •ê·œí™” ë°©ì‹ì˜ ì¥ì **
  - ì „ì²´ ì¡°íšŒ ì‹œê°„ê³¼ ì²˜ë¦¬ëŸ‰ì—ì„œ íƒì›”í•œ ì„±ëŠ¥
  - ì¡°ì¸ì´ ê±°ì˜ ì—†ê³  QueryDSLì—ì„œ ì¡°ê±´ ê²€ìƒ‰ë§Œìœ¼ë¡œ í•´ê²°ë¨
  - ì‹¤ì‹œê°„ íŠ¸ë˜í”½ì´ ì§‘ì¤‘ë˜ëŠ” ì¡°íšŒ APIì— ì í•©í•¨

<br>

- **ë‹¨ì  ë° ì£¼ì˜ì‚¬í•­**
  - ë°ì´í„° ì¼ê´€ì„±ì„ ë³´ì¥í•˜ë ¤ë©´ ìƒì„±/ìˆ˜ì • íƒ€ì´ë°ì— ì£¼ì˜ê°€ í•„ìš”
  - ìºì‹œì™€ ìœ ì‚¬í•˜ê²Œ **ë°ì´í„° ì‹±í¬ ì´ìŠˆ**ê°€ ë°œìƒí•  ìˆ˜ ìˆìŒ
  - í•˜ë‚˜ì˜ ì¿¼ë¦¬ë¡œ ë§ì€ í•„ë“œë¥¼ ì¡°íšŒí•˜ë¯€ë¡œ **ì¿¼ë¦¬ íŠœë‹ í¬ì¸íŠ¸ê°€ ëª…í™•í•¨**
  - ë‹¤ë§Œ, ê²½ë§¤ì— ë„ë‹¬í•œ í‹°ì¼“ì€ í•„ë“œì˜ ë³€ê²½ì´ í¬ì§€ ì•Šì„ ê²ƒìœ¼ë¡œ ì˜ˆìƒ.
    
<br>
    
### 8. ê²°ë¡ 
    
- **ì‹¤ì‹œê°„ìœ¼ë¡œ ë§ì€ ì¡°íšŒê°€ ë°œìƒí•˜ëŠ” ë„ë©”ì¸ì—ì„œëŠ” ë°˜ì •ê·œí™” ì ìš©ì´ íš¨ê³¼ì **
- **ì •ê·œí™” ê¸°ë°˜ ì¡°íšŒ ëŒ€ë¹„ í‰ê·  70~90% ì´ìƒ ë¹ ë¥¸ ì¡°íšŒ ì†ë„ë¥¼ ë³´ì„**
- ë‹¤ë§Œ, ë°˜ì •ê·œí™”ëœ í…Œì´ë¸”ì„ ìœ ì§€ë³´ìˆ˜ í•  ìˆ˜ ìˆë„ë¡ íŠ¸ë¦¬ê±° í˜¹ì€ ì„œë¹„ìŠ¤ ë ˆì´ì–´ì—ì„œ ì •í™•í•œ ë™ê¸°í™” ì „ëµì´ í•„ìš”í•¨
    
<br>
    
### 9. í–¥í›„ ê°œì„  ë° ê³ ë ¤ ì‚¬í•­
    
- CQRS íŒ¨í„´ ë„ì…í•˜ì—¬ ì¡°íšŒ ì „ìš© í…Œì´ë¸”ë¡œ ì™„ì „íˆ ë¶„ë¦¬ ê°€ëŠ¥
- Kafkaë‚˜ Event Streamìœ¼ë¡œ AuctionTicketInfo ìë™ ìƒì„± ê°€ëŠ¥
- ì •ê·œí™” ë°©ì‹ì€ ê´€ë¦¬ìë‚˜ í†µê³„ ì‹œìŠ¤í…œì—ì„œ ë³´ì™„ì  ì¡°íšŒì— ì‚¬ìš©

</details>

---

## ğŸš¨Â íŠ¸ëŸ¬ë¸” ìŠˆíŒ…
 
<details>
<summary><strong>@Cacheable ë™ì‘í•˜ì§€ ì•Šë˜ ë¬¸ì œ: AOP í”„ë¡ì‹œ í•œê³„ì™€ ì„œë¹„ìŠ¤ ë¶„ë¦¬ë¡œ í•´ê²°</strong></summary>
        
## ë¬¸ì œ : ìºì‹œ ë¯¸ì ìš© ì´ìŠˆ
        
## ë¬¸ì œ ë°œìƒ ë°°ê²½
        
í‹°ì¼“íŒ… ì‹œìŠ¤í…œì—ì„œ ì‚¬ìš©ìë“¤ì´ ì¢Œì„ ì˜ˆë§¤ë¥¼ ì‹œë„í•  ë•Œ, **íŠ¹ì • ê²½ê¸°ì˜ ì¢Œì„ë³„ ì˜ˆë§¤ ì—¬ë¶€ ë°ì´í„°**ëŠ” ë§¤ìš° ì§§ì€ ì‹œê°„ ì•ˆì— ëŒ€ëŸ‰ìœ¼ë¡œ ë°˜ë³µ ì¡°íšŒë©ë‹ˆë‹¤.

- ì˜ˆ: ê²½ê¸° ì˜¤í”ˆ ì§í›„ ìˆ˜ì²œ ëª…ì´ ë™ì‹œì— "ì˜ˆë§¤ ê°€ëŠ¥í•œ ì¢Œì„"ì„ ì¡°íšŒí•˜ëŠ” ìƒí™©
- ì´ëŸ¬í•œ ê³ ë¶€í•˜ íŠ¸ë˜í”½ì€ ì‹œìŠ¤í…œì˜ ì„±ëŠ¥ì„ ë‹¨ìˆ¨ì— ì €í•˜ì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
        
ë”°ë¼ì„œ ìš°ë¦¬ëŠ” **ì¡°íšŒ ì„±ëŠ¥ì„ ê·¹ëŒ€í™”**í•˜ê¸° ìœ„í•´ ì¿¼ë¦¬ íŠœë‹, ì¸ë±ìŠ¤, ìºì‹± ë„ì… ë“± ìµœì í™” ì „ëµì„ ì ìš©í–ˆìŠµë‹ˆë‹¤.
        
í•˜ì§€ë§Œ @Cacheableì„ í†µí•´ ìºì‹œë¥¼ ì ìš©í–ˆìŒì—ë„ ì„±ëŠ¥ì´ ì „í˜€ ê°œì„ ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.
        
API ì‘ë‹µ ì†ë„ ì—­ì‹œ ìºì‹œ ë¯¸ì ìš© ì‹œì™€ ë™ì¼í–ˆê³  ì¿¼ë¦¬ ë¡œê·¸ë¥¼ í™•ì¸í•˜ë‹ˆ ëª¨ë“  ìš”ì²­ë§ˆë‹¤ ì¿¼ë¦¬ê°€ ë°˜ë³µ ì‹¤í–‰ë˜ê³  ìˆì—ˆìŠµë‹ˆë‹¤.
        
   ![image](https://github.com/user-attachments/assets/691ffea0-4849-480b-a236-3e317dd9c0bb)
        
<br>
        
## ë¬¸ì œ ì¦ìƒ ìš”ì•½
        
- `@Cacheable`ì„ ì ìš©í•œ ë©”ì„œë“œê°€ **ë§¤ë²ˆ DB ì¿¼ë¦¬ë¥¼ ì‹¤í–‰**
- ìºì‹œ ì €ì¥ ë¡œê·¸/ì¡°íšŒ ë¡œê·¸ ì—†ìŒ
- ìºì‹œ ê°œì„  ì „ í…ŒìŠ¤íŠ¸ì™€ í‰ê·  ì‘ë‹µ ì‹œê°„ ë™ì¼
        
<br>
        
## ì›ì¸ ë¶„ì„: Spring AOP í”„ë¡ì‹œ êµ¬ì¡°ì˜ í•œê³„
        
### Spring AOPë€?
        
Spring AOP(Apect-Oriented Programming)ëŠ” **í•µì‹¬ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ê³¼ ê³µí†µ ê¸°ëŠ¥(íŠ¸ëœì­ì…˜, ìºì‹±, ë¡œê¹… ë“±)ì„ ë¶„ë¦¬**í•´ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë” ëª¨ë“ˆí™”í•  ìˆ˜ ìˆë„ë¡ ë„ì™€ì£¼ëŠ” í”„ë¡œê·¸ë˜ë° ê¸°ë²•ì…ë‹ˆë‹¤.
        
Springì€ ë‚´ë¶€ì ìœ¼ë¡œ **í”„ë¡ì‹œ ê°ì²´**ë¥¼ ìƒì„±í•´ ì´ëŸ° ê¸°ëŠ¥ì„ ë¼ì›Œ ë„£ìŠµë‹ˆë‹¤.
        
> ì˜ˆë¥¼ ë“¤ì–´, @Cacheableì´ ë¶™ì€ ë©”ì„œë“œê°€ í˜¸ì¶œë˜ë©´
> 
> 
> â†’ Springì€ ë¨¼ì € "ì´ì „ì— ë™ì¼í•œ íŒŒë¼ë¯¸í„°ë¡œ í˜¸ì¶œëœ ê²°ê³¼ê°€ ìˆë‚˜?"ë¥¼ ìºì‹œì—ì„œ ì¡°íšŒí•œ ë’¤
> 
> â†’ ìˆë‹¤ë©´ DB ëŒ€ì‹  ìºì‹œ ì‘ë‹µì„ ë°˜í™˜í•˜ê³ ,
> 
> â†’ ì—†ë‹¤ë©´ ë©”ì„œë“œë¥¼ ì‹¤í–‰í•œ ë’¤ ê²°ê³¼ë¥¼ ìºì‹œì— ì €ì¥í•©ë‹ˆë‹¤.
> 
        
ì´ ëª¨ë“  ê³¼ì •ì€ **í”„ë¡ì‹œ(proxy)** ë¼ëŠ” ì¤‘ê°„ ê°ì²´ê°€ ê°œì…í•´ì„œ ìë™ìœ¼ë¡œ ìˆ˜í–‰í•©ë‹ˆë‹¤.
        
### ë¬¸ì œì˜ ë³¸ì§ˆ: "ìê¸° ìì‹  í˜¸ì¶œ ì‹œ í”„ë¡ì‹œë¥¼ ê±°ì¹˜ì§€ ì•ŠìŒ"
        
Spring AOPëŠ” ê¸°ë³¸ì ìœ¼ë¡œ **í”„ë¡ì‹œ ê°ì²´ë¥¼ í†µí•´ ì™¸ë¶€ í˜¸ì¶œì´ ì´ë£¨ì–´ì ¸ì•¼ ë™ì‘**í•©ë‹ˆë‹¤.
        
ê·¸ëŸ¬ë‚˜ ë‹¤ìŒê³¼ ê°™ì€ ì½”ë“œì²˜ëŸ¼ **ë™ì¼ í´ë˜ìŠ¤ ë‚´ë¶€ì—ì„œ ìì‹ ì´ ê°€ì§„ ë©”ì„œë“œë¥¼ ì§ì ‘ í˜¸ì¶œ**í•˜ë©´ í”„ë¡ì‹œê°€ ê°œì…í•˜ì§€ ëª»í•˜ê²Œ ë©ë‹ˆë‹¤.
        
- ì˜ˆì œ
            
   ```java
            @Service
            public class GameService {
            
                // ìºì‹±ì„ ì‹œë„í•œ ë©”ì„œë“œ
                @Cacheable(value = "seatCountsBySectionType", key = "#gameId")
                public List<SectionTypeSeatCountResponse> getSectionSeatCountsCached(Long gameId) {
                    // í˜¸ì¶œë  ë•Œë§ˆë‹¤ DB ì¿¼ë¦¬ê°€ ì‹¤í–‰ë¨
                    return gameRepository.findUnBookedSeatsCountInSectionTypeByGameIdV2(gameId);
                }
            
                // ë‹¤ë¥¸ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì—ì„œ ìºì‹± ëŒ€ìƒ ë©”ì„œë“œ í˜¸ì¶œ
                public StadiumGetResponse getStadiumAndSectionSeatCountsV2(Long gameId) {
                    List<SectionTypeSeatCountResponse> sectionBookedSeatCounts = getSectionSeatCountsCached(gameId); // âŒ í”„ë¡ì‹œ ê±°ì¹˜ì§€ ì•ŠìŒ!
                    ...
                }
            }
    ```
            
- ìœ„ ì˜ˆì œì—ì„œ `getSectionSeatCountsCached()`ëŠ” **@Cacheableì´ ë¶™ì–´ ìˆì§€ë§Œ**, **ê°™ì€ í´ë˜ìŠ¤ ë‚´ë¶€ì—ì„œ ì§ì ‘ í˜¸ì¶œë˜ì—ˆê¸° ë•Œë¬¸ì— í”„ë¡ì‹œë¥¼ ê±°ì¹˜ì§€ ì•Šê³ **, ê²°êµ­ **AOPë„ ë™ì‘í•˜ì§€ ì•Šê²Œ ë©ë‹ˆë‹¤**.
            
- ê·¸ë˜ì„œ **ìºì‹œë¥¼ ì¡°íšŒí•˜ê±°ë‚˜ ì €ì¥í•˜ëŠ” ë¡œì§ì´ ì•„ì˜ˆ ìˆ˜í–‰ë˜ì§€ ì•Šê²Œ ë˜ëŠ” ê²ƒ**ì…ë‹ˆë‹¤.
        
í•´ê²° ë°©ì•ˆ: **ìºì‹œ ëŒ€ìƒ ë©”ì„œë“œë¥¼ ì™¸ë¶€ ì„œë¹„ìŠ¤ë¡œ ë¶„ë¦¬**
        
<br>
        
## í•´ê²° ë°©ì•ˆ: **ìºì‹œ ëŒ€ìƒ ë©”ì„œë“œë¥¼ ì™¸ë¶€ ì„œë¹„ìŠ¤ë¡œ ë¶„ë¦¬**
        
### ì „ëµ: **í”„ë¡ì‹œ ê°ì²´ê°€ ê°œì…í•  ìˆ˜ ìˆë„ë¡ êµ¬ì¡° ë¶„ë¦¬**
        
- `@Cacheable`ì´ ë¶™ì€ ë©”ì„œë“œë¥¼ **GameCacheServiceë¼ëŠ” ë³„ë„ í´ë˜ìŠ¤**ë¡œ ë¶„ë¦¬
- `GameService`ì—ì„œ í•´ë‹¹ ë©”ì„œë“œë¥¼ í˜¸ì¶œí•  ë•Œ, ì´ì œëŠ” Springì´ ìƒì„±í•œ **í”„ë¡ì‹œ ê°ì²´ë¥¼ í†µí•´ í˜¸ì¶œ**í•˜ê²Œ ë˜ì–´ **AOP ê¸°ëŠ¥(@Cacheable)ì´ ì •ìƒì ìœ¼ë¡œ ë™ì‘**
- ì½”ë“œ
            
  ```java
            @Service
            public class GameCacheService {
            	@Cacheable(value = "seatCountsBySectionType", key = "#gameId")
            	public List<SectionTypeSeatCountResponse> getSectionSeatCountsCached(Long gameId) {
            		return gameRepository.findUnBookedSeatsCountInSectionTypeByGameIdV2(gameId);
            	}
            }
            
            @Service
            public class GameService {
                private final GameCacheService gameCacheService;
            
                public StadiumGetResponse getStadiumAndSectionSeatCountsV2(Long gameId) {
                    // í”„ë¡ì‹œ ê°ì²´ë¥¼ í†µí•´ ìºì‹œê°€ ê°œì…ë¨
                    List<SectionTypeSeatCountResponse> sectionBookedSeatCounts = gameCacheService.getSectionSeatCountsCached(gameId);
                    ...
                }
            }
            
  ```
                
<br>
        
## í…ŒìŠ¤íŠ¸
        
- k6ë¥¼ í™œìš©í•˜ì—¬ ì‹¤ì œ í‹°ì¼“íŒ… í™˜ê²½ê³¼ ìœ ì‚¬í•˜ê²Œ ì¢Œì„ ì¡°íšŒì™€ ì¢Œì„ ì˜ˆë§¤ ë¡œì§ì„ ë™ì‹œì— ì‹¤í–‰
- ìµœëŒ€ ì´ˆë‹¹ 30ëª…ì˜ ì¢Œì„ ì˜ˆë§¤ì™€ ì´ˆë‹¹ 5000ëª…ì˜ ì¢Œì„ ì •ë³´ ì¡°íšŒê°€ ë°œìƒ
- í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤ ì½”ë“œ
            
  ```java
            export let options = {
                scenarios: {
                    viewers: {
                        executor: 'ramping-arrival-rate',
                        startRate: 1000,
                        timeUnit: '1s',
                        preAllocatedVUs: 500,
                        maxVUs: 1000,
                        stages: [
                            { target: 5000, duration: '30s' },  // í‹°ì¼“ ì˜¤í”ˆ ì§í›„
                            { target: 3000, duration: '30s' },  // ì‚´ì§ ê°ì†Œ
                            { target: 1500, duration: '1m' },   // ì•ˆì •í™”
                            { target: 800, duration: '1m' },    // ì ì°¨ ì¤„ì–´ë“¦
                            { target: 200, duration: '2m' },    // ì†Œê°• ìƒíƒœ
                            { target: 50, duration: '30s' },     // ë§ˆë¬´ë¦¬
                        ],
                        exec: 'seatView',
                    },
            
                    // ğŸ« ì˜ˆë§¤ ì‹œë‚˜ë¦¬ì˜¤ (reserveSeat)
                    bookers: {
                        executor: 'ramping-arrival-rate',
                        startRate: 1,
                        timeUnit: '1s',
                        preAllocatedVUs: 200,
                        maxVUs: 500,
                        stages: [
                            { target: 30, duration: '30s' },  // ì˜ˆë§¤ì ëª°ë¦¼
                            { target: 15, duration: '30s' },  // ê°ì†Œ
                            { target: 10, duration: '1m' },    // ì•ˆì •
                            { target: 3, duration: '1m' },    // ì†Œê°•
                            { target: 2, duration: '2m' },    // ê±°ì˜ ì—†ìŒ
                            { target: 1, duration: '30s' },   // ì¢…ë£Œ
                        ],
                        exec: 'reserveSeat',
                    },
                },
            };
  ```
            
- í…ŒìŠ¤íŠ¸ ê²°ê³¼
  - ìºì‹œ ì ìš© ì „
            
      ![image](https://github.com/user-attachments/assets/c92c8f11-a74e-4863-99e5-5331773186ab)
            
  - ìºì‹œ ì ìš© í›„
            
      ![image](https://github.com/user-attachments/assets/ae63b675-8e9b-433b-ab9f-baedbd162238)

            
        
### í…ŒìŠ¤íŠ¸ ìš”ì•½
        
| í•­ëª© | **ìºì‹œ ë¯¸ì ìš©** | **ìºì‹œ ì ìš© í›„** |
| --- | --- | --- |
| ğŸ•’ **í‰ê·  ì‘ë‹µ ì‹œê°„** | **6.05ì´ˆ** | **284ms** |
| ğŸ•’ **P90 ì‘ë‹µ ì‹œê°„** | **~7.48ì´ˆ** | **~662ms** |
| ğŸ•’ **P95 ì‘ë‹µ ì‹œê°„** | ~ 7.8ì´ˆ | ~737ms |
| âš¡ **ì²˜ë¦¬ ìš”ì²­ ìˆ˜ (iterations)** | 55,562 | ì•½ 120,000 ì´ìƒ |
| ğŸ“‰ **ë¶€í•˜ ì‹¤íŒ¨ìœ¨ (http_req_failed)** | 0.56% | 0.11% ì´í•˜ |
        
  ![image](https://github.com/user-attachments/assets/e9c83c08-defe-4c2c-9266-70efc79a497e)
        
- ìºì‹œ ì ìš© ì „í›„ë¥¼ ë¹„êµí•œ ê²°ê³¼, í‰ê·  ì‘ë‹µ ì‹œê°„ì€ ì•½ **95% ë‹¨ì¶•** ë˜ì—ˆê³ ,
- P90ê³¼ P95 ì‘ë‹µ ì‹œê°„ë„ ê°ê° **91% 90%** ê°œì„ ë˜ì—ˆìŠµë‹ˆë‹¤.
- **ì „ì²´ì ìœ¼ë¡œ 90~95%ì˜ ì„±ëŠ¥ í–¥ìƒ**ì„ í™•ì¸í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤.
- ë˜í•œ ì²˜ë¦¬ ìš”ì²­ ìˆ˜ëŠ” 2ë°° ì´ìƒ ì¦ê°€í–ˆê³  ë¶€í•˜ ì‹¤íŒ¨ìœ¨ ì—­ì‹œ 5ë°° ê°ì†Œí–ˆìŠµë‹ˆë‹¤!
        
<br>
        
## ë°°ìš´ì 
        
- Springì˜ AOP ê¸°ë°˜ ì–´ë…¸í…Œì´ì…˜ (`@Cacheable`, `@Transactional`, `@Async` ë“±)ì€ **ë™ì¼ í´ë˜ìŠ¤ ë‚´ë¶€ í˜¸ì¶œ ì‹œ ë™ì‘í•˜ì§€ ì•ŠëŠ”ë‹¤.**
- ì´ëŸ¬í•œ ë™ì‘ ë°©ì‹ì€ **í”„ë¡ì‹œ íŒ¨í„´ì˜ êµ¬ì¡°ì  íŠ¹ì„±**ì— ê¸°ì¸í•˜ë¯€ë¡œ, â†’ **ì„¤ê³„ ì‹œ í”„ë¡ì‹œ ëŒ€ìƒ ë©”ì„œë“œëŠ” ì™¸ë¶€ ì„œë¹„ìŠ¤ë¡œ ë¶„ë¦¬**í•˜ëŠ” ê²ƒì´ ì•ˆì „
- ë‹¨ìˆœíˆ ì–´ë…¸í…Œì´ì…˜ì„ ë¶™ì´ëŠ” ê²ƒë§Œìœ¼ë¡œ ì¶©ë¶„í•˜ì§€ ì•Šê³  ë™ì‘ ë°©ì‹ì— ëŒ€í•œ ì´í•´ê°€ í•„ìš”í•˜ë‹¤ëŠ” ê²ƒì„ ê¹¨ë‹¬ì•˜ë‹¤!

</details>
    
<details>
<summary><strong>@Transactional ì‚¬ìš© ì‹œ ë¶ˆí•„ìš”í•œ DB ì»¤ë„¥ì…˜ ì ìœ </strong></summary>
      
## ë¬¸ì œ ë°œìƒ ë°°ê²½
        
í‹°ì¼“íŒ… ì‹œìŠ¤í…œì—ì„œ ì˜ˆì•½ ìš”ì²­ì´ ë“¤ì–´ì˜¬ ë•Œ, **ëª¨ë“  ìœ ì €ê°€ ë™ì¼í•œ ì¢Œì„ì„ ì˜ˆë§¤í•˜ëŠ” ìƒí™©ì„ ê°€ì •**í•˜ì—¬ ë¶€í•˜ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í–ˆìŠµë‹ˆë‹¤.

- í•µì‹¬ ì „ëµì€ DB ë¶€í•˜ë¥¼ ìµœì†Œí™”í•˜ê¸° ìœ„í•´ **Redisì—ì„œ ë¨¼ì € ì¢Œì„ ì¤‘ë³µì„ ê²€ì¦**í•˜ê³ , ì¤‘ë³µì´ ì•„ë‹Œ ê²½ìš°ì—ë§Œ DBì— ì˜ˆì•½ ë°ì´í„°ë¥¼ ìƒì„±í•˜ëŠ” ë°©ì‹ì…ë‹ˆë‹¤.
            
- í…ŒìŠ¤íŠ¸ ì¡°ê±´ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:
  - VUser 2000ëª…
  - ì´ 50ì´ˆê°„ í…ŒìŠ¤íŠ¸ ì§„í–‰
  - ëª¨ë“  ìœ ì €ëŠ” ë™ì¼í•œ ì¢Œì„ IDë¥¼ ëŒ€ìƒìœ¼ë¡œ ì˜ˆë§¤ ì‹œë„

<br>
        
## ë¬¸ì œ ì¦ìƒ ìš”ì•½
        
  ![image](https://github.com/user-attachments/assets/1b9d61a6-e5de-4096-8166-8b899b634d2e)
        
- ëª¨ë“  ìš”ì²­ì´ Redisì—ì„œ ì¤‘ë³µìœ¼ë¡œ íŒë³„ë˜ì–´ **DB ì‘ì—…ì€ ìˆ˜í–‰ë˜ì§€ ì•Šì•˜ìŒì—ë„**, DB ì»¤ë„¥ì…˜ í’€(Pool)ì˜ **Pending ì»¤ë„¥ì…˜ ìˆ˜ê°€ 200ê¹Œì§€ ì¦ê°€**
            
- ê²°êµ­ DB ì»¤ë„¥ì…˜ì´ ì†Œì§„ë˜ë©° ë‹¤ë¥¸ ì‘ì—…ì— ì˜í–¥ ë°œìƒ ê°€ëŠ¥ì„± í™•ì¸

<br>
        
## ì›ì¸ ë¶„ì„
        
`@Transactional`ì´ DB ì‘ì—… ì „ì´ë¼ë„ ì»¤ë„¥ì…˜ì„ í™•ë³´í•¨

Springì˜ `@Transactional`ì€ ë‹¨ìˆœíˆ íŠ¸ëœì­ì…˜ ì‹œì‘/ì»¤ë°‹ë§Œ ì²˜ë¦¬í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼, **íŠ¸ëœì­ì…˜ì´ ì‹œì‘ë˜ëŠ” ì‹œì ì—ì„œ Connectionì„ í™•ë³´**í•˜ë ¤ê³  í•©ë‹ˆë‹¤.

<br>
  
### ì¦ëª… í…ŒìŠ¤íŠ¸
        
  ```java
        @Transactional
        public void test() {
            // ì•„ë¬´ ë¡œì§ ì—†ìŒ
        }
  ```
        
- ìœ„ì™€ ê°™ì´ DBì™€ ë¬´ê´€í•œ ë¹ˆ ë©”ì„œë“œì— `@Transactional`ì„ ë¶™ì¸ í›„ ë™ì¼í•œ ì¡°ê±´ìœ¼ë¡œ ë¶€í•˜ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í–ˆìŒ
- í…ŒìŠ¤íŠ¸ ê²°ê³¼, DB ì»¤ë„¥ì…˜ì´ **ë™ì¼í•˜ê²Œ í™•ë³´ë˜ëŠ” í˜„ìƒ í™•ì¸**
        
    ![image](https://github.com/user-attachments/assets/053d912c-51b2-48cf-82a5-1ec8e80a7555)
        
ğŸ‘‰ ì¦‰, ì‹¤ì œ DB ì‘ì—…ì´ ì—†ë”ë¼ë„ @Transactional ì–´ë…¸í…Œì´ì…˜ë§Œ ìˆì–´ë„ Springì€ ê¸°ë³¸ì ìœ¼ë¡œ DB ì»¤ë„¥ì…˜ì„ ì ìœ í•˜ê²Œ ë©ë‹ˆë‹¤.
        
## í•´ê²° ë°©ì•ˆ: **íŠ¸ëœì­ì…˜ ì „ ë‹¨ê³„(ì„  ê²€ì¦ ë¡œì§)ì™€ DB ë¡œì§ì˜ ì±…ì„ ë¶„ë¦¬**

<br>
  
### êµ¬ì¡° ë¦¬íŒ©í„°ë§
        
- ê¸°ì¡´ì—ëŠ” Redis ì¢Œì„ ê²€ì¦ê³¼ DB ì˜ˆì•½ ìƒì„±ì´ **í•˜ë‚˜ì˜ `@Transactional` ë©”ì„œë“œ ë‚´ë¶€ì— ê³µì¡´**
- ì´ë¥¼ **ë‘ ê°œì˜ ì„œë¹„ìŠ¤ë¡œ ë¶„ë¦¬**í•˜ì—¬, Redis ê²€ì¦ ë¡œì§ì€ íŠ¸ëœì­ì…˜ ì™¸ë¶€ì—ì„œ ìˆ˜í–‰ë˜ë„ë¡ ê°œì„ 
- ë¦¬íŒ©í† ë§ ì „ ì½”ë“œ
            
  í•˜ë‚˜ì˜ íŠ¸ëœì­ì…˜ì— ëª¨ë“  ê²€ì¦, ìƒì„œ ë¡œì§ì´ ëª¨ì—¬ìˆìŒ
            
   ```java
            @Transactional
            	public ReservationResponse createReservation(AuthUser auth, ReservationCreateRequest reservationCreateRequest) {
            
            		//ì´ë¯¸ ì˜ˆì•½ëœ ì¢Œì„ì´ ì¡´ì¬í•˜ëŠ”ì§€ ì²´í¬
            		ticketSeatService.checkDuplicateSeats(reservationCreateRequest.getSeatIds(),
            			reservationCreateRequest.getGameId());
            		//ê²€ì¦ì´ ì™„ë£Œë˜ë©´ ì¢Œì„ ì ìœ 
            		seatHoldRedisUtil.holdSeatAtomic(
            			reservationCreateRequest.getGameId(),
            			reservationCreateRequest.getSeatIds(),
            			String.valueOf(auth.getMemberId())
            		);
            
            		GameDto gameDto = null;
            		List<SeatDto> seats = new ArrayList<>();
            		try {
            			gameDto = gameClient.getGame(reservationCreateRequest.getGameId());
            			seats = seatClient.getSeatsByGameAndSection(
            				reservationCreateRequest.getGameId(),
            				reservationCreateRequest.getSectionId(),
            				reservationCreateRequest.getSeatIds()
            			);
            		} catch (Exception e) {
            			//ê²½ê¸°, ì¢Œì„ ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ëŠ”ë„ì¤‘ ì˜ˆì™¸ë°œìƒ ì‹œ ì„ ì í–ˆë˜ ì¢Œì„ì„ í•´ì œ
            			seatHoldRedisUtil.releaseSeatAtomic(reservationCreateRequest.getSeatIds(),
            				reservationCreateRequest.getGameId());
            			throw new ServerException(SEAT_NOT_FOUND);
            		}
            
            		int seatPrice = seats.stream().mapToInt(SeatDto::getPrice).sum();
            
            		//ì˜ˆì•½ ë°ì´í„° ìƒì„±
            		Reservation reservation = new Reservation(
            			auth.getMemberId(),
            			gameDto.getId(),
            			"WAITING_PAYMENT",
            			seatPrice
            		);
            		List<ReserveSeat> ReserveSeatList = ReserveSeat.from(reservationCreateRequest.getSectionId(), seats);
            		for (ReserveSeat reserveSeat : ReserveSeatList) {
            			reservation.addSeat(reserveSeat);
            		}
            		reservationRepository.save(reservation);
            
            		return ReservationResponse.from(reservation, gameDto, seats);
            	}
   ```
            
- ë¦¬íŒ©í† ë§ í›„ ì½”ë“œ
            
  íŠ¸ëœì­ì…˜ì´ í•„ìš”í•œ ì‘ì—…(ìƒì„±) ë¶€ë¶„ë§Œ ë”°ë¡œ ì„œë¹„ìŠ¤ë¥¼ ë¶„ë¦¬í•˜ì—¬ ì˜ˆì•½ë¡œì§ ë¦¬íŒ©í† ë§
            
  ```java
            //ì˜ˆì•½ ë°ì´í„° ìƒì„± ì„œë¹„ìŠ¤ ë¶„ë¦¬
            public class ReservationCreateService {
            	private final ReservationRepository reservationRepository;
            	private final ReservationValidator reservationValidator;
            	private final SeatClient seatClient;
            
            	@Transactional
            	public ReservationResponse createReservation(AuthUser auth, ReservationCreateRequest reservationCreateRequest) {
            			//ë°ì´ì„œ ìƒì„± ë¡œì§
            	}
            }
            
            public class ReservationService {
            	public ReservationResponse processReserve(AuthUser auth, ReservationCreateRequest reservationCreateRequest) {
            			seatHoldRedisUtil.holdSeatAtomic(
            				reservationCreateRequest.getGameId(),
            				reservationCreateRequest.getSeatIds(),
            				String.valueOf(auth.getMemberId())
            			);
            			try {
            				ReservationResponse reservation = reservationCreateService.createReservation(
            					auth,
            					reservationCreateRequest
            				);
            				return reservation;
            			} catch (Exception e) {
            				seatHoldRedisUtil.releaseSeatAtomic(reservationCreateRequest.getSeatIds(),reservationCreateRequest.getGameId());
            				throw e;
            			}
            		}
            }
            	
            	
  ```

<br>
   
## ê²°ê³¼
        
   ![image](https://github.com/user-attachments/assets/3e09567c-3c0f-4e08-95b8-baf0dc7040fd)
        
- DB ì»¤ë„¥ì…˜ ì†Œëª¨ ì—†ìŒ

<br>

## ë°°ìš´ì 
        
- `@Transactional`ì€ **DB ì¿¼ë¦¬ ì‹¤í–‰ ì—¬ë¶€ì™€ ë¬´ê´€í•˜ê²Œ Connectionì„ ì ìœ **í•œë‹¤.
- **íŠ¸ëœì­ì…˜ì´ ë°˜ë“œì‹œ í•„ìš”í•œ ë¡œì§ê³¼ ê·¸ë ‡ì§€ ì•Šì€ ë¡œì§ì€ ì±…ì„ì„ ë¶„ë¦¬**í•´ì•¼ í•œë‹¤.
- Redisë¥¼ í†µí•œ ì„  í•„í„°ë§ì„ ì ìš©í•˜ë”ë¼ë„, `@Transactional`ì´ í•¨ê»˜ ì ìš©ë˜ì–´ ìˆë‹¤ë©´ **ë¶ˆí•„ìš”í•œ ì»¤ë„¥ì…˜ ì†Œëª¨ë¡œ ë³‘ëª©ì´ ë°œìƒ**í•  ìˆ˜ ìˆë‹¤.
- ëŒ€ëŸ‰ ìš”ì²­ íŠ¸ë˜í”½ì„ ì²˜ë¦¬í•˜ëŠ” ì‹œìŠ¤í…œì—ì„œëŠ” ì‘ì€ ì„¤ì • í•˜ë‚˜ê°€ ë³‘ëª© ì§€ì ì´ ë  ìˆ˜ ìˆìœ¼ë¯€ë¡œ, **JDBC ì»¤ë„¥ì…˜ ì‚¬ìš© ì‹œì ì— ëŒ€í•œ ëª…í™•í•œ ì´í•´ê°€ í•„ìˆ˜**ì´ë‹¤.

<br>

## ì›ì¸ ë¶„ì„: `@Transactional`ì´ DB ì‘ì—… ì „ì´ë¼ë„ ì»¤ë„¥ì…˜ì„ í™•ë³´í•¨
    
Springì˜ `@Transactional`ì€ ë‹¨ìˆœíˆ íŠ¸ëœì­ì…˜ ì‹œì‘/ì»¤ë°‹ë§Œ ì²˜ë¦¬í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼, **íŠ¸ëœì­ì…˜ì´ ì‹œì‘ë˜ëŠ” ì‹œì ì—ì„œ Connectionì„ í™•ë³´**í•˜ë ¤ê³  í•©ë‹ˆë‹¤.
    
</details>
    
<details>
<summary><strong>ì´ë²¤íŠ¸ ê¸°ë°˜ ìºì‹œ ë™ê¸°í™” êµ¬ì¡° ë„ì… ë°°ê²½ê³¼ ë¦¬íŒ©í† ë§ ê³¼ì •</strong></summary>
        
### 1. ë¬¸ì œ ìš”ì•½
        
ê²½ë§¤ ì…ì°° ì‹œìŠ¤í…œì—ì„œ **DB ì…ì°°ê°€ì™€ Redis ìºì‹œ ì…ì°°ê°€ ê°„ ë¶ˆì¼ì¹˜ë¡œ ì¸í•´ ì‚¬ìš©ì ì…ì°°ì´ ë°˜ë³µì ìœ¼ë¡œ ì‹¤íŒ¨í•˜ëŠ” ì´ìŠˆ**ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.
        
íŠ¹íˆ ë‹¤ìŒê³¼ ê°™ì€ ìƒí™©ì´ ë¬¸ì œì˜ í•µì‹¬ì´ì—ˆìŠµë‹ˆë‹¤:
- DB ì…ì°°ê°€ëŠ” `2000ì›`, Redis ì…ì°°ê°€ëŠ” `2100ì›`ìœ¼ë¡œ ì¡°íšŒ
- ì‚¬ìš©ìëŠ” ë¶„ëª…íˆ ì…ì°° ì¡°ê±´ì„ ë§Œì¡±í–ˆì§€ë§Œ ê³„ì†í•´ì„œ ì‹¤íŒ¨ ì²˜ë¦¬ë¨
        
ê²°êµ­ ì´ëŠ” **ë°ì´í„° ì •í•©ì„± ë¬¸ì œ**ì˜€ê³ , ìºì‹œì™€ íŠ¸ëœì­ì…˜ì˜ ë¹„ë™ê¸°ì  ì²˜ë¦¬ ìˆœì„œì—ì„œ ë°œìƒí•œ ì´ìŠˆë¡œ íŒŒì•…ë˜ì—ˆìŠµë‹ˆë‹¤.
        
<br>
        
### 2. ë¬¸ì œ ë°œìƒ ë°°ê²½
        
ê¸°ì¡´ êµ¬ì¡°ì—ì„œëŠ” ì…ì°° ë“±ë¡ ì‹œ ë‹¤ìŒê³¼ ê°™ì€ íë¦„ìœ¼ë¡œ ì²˜ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤:

1. ì‚¬ìš©ìì˜ ì…ì°° ìš”ì²­ ìˆ˜ì‹ 
2. DBì— ì…ì°° ë‚´ì—­ ì €ì¥ (ë¹„ê´€ì  ë½ ì ìš©)
3. **ì…ì°°ê°€ë¥¼ Redisì— ì—…ë°ì´íŠ¸**
        
ì´ êµ¬ì¡°ëŠ” í•œ ê°€ì§€ ì¤‘ìš”í•œ ë¬¸ì œë¥¼ ë‚´í¬í•˜ê³  ìˆì—ˆìŠµë‹ˆë‹¤.
        
> "DB íŠ¸ëœì­ì…˜ì´ ì•„ì§ ì»¤ë°‹ë˜ì§€ ì•Šì•˜ëŠ”ë°, Redisì—ëŠ” ì…ì°°ê°€ê°€ ë¨¼ì € ë°˜ì˜ë˜ëŠ” ìƒí™©"
> 
        
ì¦‰, **íŠ¸ëœì­ì…˜ ì»¤ë°‹ ì „ì— Redisì— ì…ì°°ê°€ë¥¼ ë¨¼ì € ì—…ë°ì´íŠ¸í•´ë²„ë ¸ê³ **, ì´í›„ íŠ¸ëœì­ì…˜ì´ ë¡¤ë°±ë˜ê±°ë‚˜ íƒ€ì„ì•„ì›ƒì´ ë°œìƒí•˜ë©´ DBì™€ Redis ê°„ ì…ì°°ê°€ê°€ ì–´ê¸‹ë‚˜ê²Œ ë˜ëŠ” ê²ƒì…ë‹ˆë‹¤.
        
### ğŸ” ì™œ DBëŠ” 2000ì›ì¸ë° RedisëŠ” 2100ì›ì´ì—ˆì„ê¹Œ?
        
ê²½ë§¤ ì…ì°° ê¸°ëŠ¥ì—ì„œëŠ” Redisì— ì €ì¥ëœ **í˜„ì¬ ì…ì°°ê°€**ê°€ ê¸°ì¤€ì´ ë©ë‹ˆë‹¤. ì‚¬ìš©ìê°€ ì…ì°°ì„ ì‹œë„í•˜ë©´ ë‹¤ìŒ ë‘ ê°€ì§€ ë¹„êµê°€ ë™ì‹œì— ì¼ì–´ë‚©ë‹ˆë‹¤:
        
- Redisì˜ ì…ì°°ê°€ì™€ ë™ì¼í•œ ê¸ˆì•¡ì¸ê°€? âœ…
- DBì— ì €ì¥ëœ ì…ì°°ê°€ì™€ ë™ì¼í•œ ê¸ˆì•¡ì¸ê°€? âœ…
        
í•˜ì§€ë§Œ ë‹¹ì‹œì—ëŠ” ë‹¤ìŒê³¼ ê°™ì€ ë¬¸ì œê°€ ìˆì—ˆìŠµë‹ˆë‹¤:
        
1. **ì…ì°° ìš”ì²­ ì²˜ë¦¬ ì¤‘ íŠ¸ëœì­ì…˜ì´ ì»¤ë°‹ë˜ê¸° ì „ì—**, Redisì˜ ì…ì°°ê°€ê°€ ë¨¼ì € ê°±ì‹ ë˜ì—ˆìŠµë‹ˆë‹¤.
2. í•˜ì§€ë§Œ DB íŠ¸ëœì­ì…˜ì´ ì¤‘ê°„ì— ì‹¤íŒ¨í•˜ê±°ë‚˜ ë¡¤ë°±ë˜ë©´â€¦
   - RedisëŠ” ì´ë¯¸ 2100ì›ìœ¼ë¡œ ì˜¬ë¼ê°„ ìƒíƒœ
   - DBëŠ” ì—¬ì „íˆ 2000ì›
3. ì´ ìƒíƒœì—ì„œ ë‹¤ë¥¸ ì‚¬ìš©ìê°€ ì…ì°°ì„ ì‹œë„í•˜ë©´:
   - Redis ê¸°ì¤€ìœ¼ë¡œëŠ” 2100ì›ì„ ìš”êµ¬í•˜ì§€ë§Œ
   - DBëŠ” ì•„ì§ 2000ì›ì´ë¯€ë¡œ **ë¶ˆì¼ì¹˜ ìƒíƒœê°€ ë°œìƒí•˜ê³ , ì…ì°° ì‹¤íŒ¨**
        
ì¦‰, **Redisì™€ DBì˜ ìƒíƒœê°€ ì¼ì‹œì ìœ¼ë¡œ ë¶„ë¦¬ë˜ì—ˆê³ **, ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì€ Redisë¥¼ ìš°ì„  ê¸°ì¤€ìœ¼ë¡œ íŒë‹¨í•˜ë‹¤ ë³´ë‹ˆ ìµœì‹ í™” ë˜ì§€ ì•Šì€ ë°ì´í„°ë¡œ ê°„ì£¼ë˜ì–´ ì‹¤íŒ¨ê°€ ë°˜ë³µëœ ê²ƒì…ë‹ˆë‹¤.
        
<br>
        
### 3. ì›ì¸ ë¶„ì„: íŠ¸ëœì­ì…˜ ì»¤ë°‹ ì „ì— Redis ì—…ë°ì´íŠ¸
        
| **ìˆœë²ˆ** | **ì‘ì—…** | **ì„¤ëª…** |
| --- | --- | --- |
| **1** | ì…ì°° ìš”ì²­ ìˆ˜ì‹  | ì‚¬ìš©ìê°€ ì…ì°°ê°€ë¥¼ ì œì‹œ |
| **2** | DB ì €ì¥ ì‹œë„ | `@Transactional` ì•ˆì—ì„œ ì…ì°°ê°€, ì…ì°°ì ë“± ì €ì¥ |
| **3** | **Redis ì…ì°°ê°€ ì—…ë°ì´íŠ¸** | DB ì €ì¥ ì„±ê³µ ì—¬ë¶€ì™€ ê´€ê³„ì—†ì´ ì‹¤í–‰ë¨ âŒ |
| **4** | ì»¤ë„¥ì…˜ íƒ€ì„ì•„ì›ƒ ë˜ëŠ” ë¡¤ë°± | DBì—ëŠ” ë°˜ì˜ ì•ˆ ë¨, Redisì—ëŠ” ë°˜ì˜ë¨ âŒ |
| **5** | ì‚¬ìš©ì ì¬ì…ì°° ì‹œë„ | Redis ì…ì°°ê°€ ê¸°ì¤€ìœ¼ë¡œ ìµœì‹ í™” ë˜ì§€ ì•Šì•„ ì˜ˆì™¸ ì²˜ë¦¬ë¨ âŒ |
        
ì¦‰, **íŠ¸ëœì­ì…˜ì´ ì‹¤ì œë¡œ ì™„ë£Œë˜ê¸° ì „ì— Redisì— ê°’ì´ ë¨¼ì € ë°˜ì˜ë˜ëŠ” êµ¬ì¡°**ê°€ ê°€ì¥ í•µì‹¬ì ì¸ ë¬¸ì œì˜€ìŠµë‹ˆë‹¤.
        
<br>
        
### 4. ê°œì„  ì „ëµ: **ì´ë²¤íŠ¸ ê¸°ë°˜ ì²˜ë¦¬ + íŠ¸ëœì­ì…˜ í›„ì²˜ë¦¬ ì ìš©**
        
### âœ… ê°œì„  ì „ êµ¬ì¡°
        
  ```
  Bid ìš”ì²­ â†’ DB ì €ì¥ â†’ Redis ì¦‰ì‹œ ì—…ë°ì´íŠ¸ â†’ ì‘ë‹µ
        
  ```
    
- ë¬¸ì œ: íŠ¸ëœì­ì…˜ ì»¤ë°‹ ì—¬ë¶€ì™€ ê´€ê³„ì—†ì´ Redisê°€ ì—…ë°ì´íŠ¸ë¨
        
### âœ… ê°œì„  í›„ êµ¬ì¡° (ë„ì…í•œ êµ¬ì¡°)
        
```
        Bid ìš”ì²­ â†’ DB ì €ì¥ â†’ ApplicationEvent ë°œí–‰ â†’ ì‘ë‹µ
                                          â†“
                             (íŠ¸ëœì­ì…˜ ì»¤ë°‹ ì´í›„ ì‹¤í–‰)
                            Redis ì…ì°°ê°€ ì—…ë°ì´íŠ¸ (BidEventListener)
        
```
        
- í•µì‹¬: `@TransactionalEventListener(phase = AFTER_COMMIT)`ë¥¼ í†µí•´ **íŠ¸ëœì­ì…˜ì´ ì„±ê³µí•œ ê²½ìš°ì—ë§Œ Redisë¥¼ ê°±ì‹ **
        
  ```java
        @EventListener
        @TransactionalEventListener(phase = TransactionPhase.AFTER_COMMIT)
        public void updateBidCache(BidUpdateEvent event) {
            auctionBidRedisUtil.setBidPoint(event.getAuctionId(), event.getBidPoint());
        }
        
  ```
        
<br>
        
### 5. í…ŒìŠ¤íŠ¸ ê²°ê³¼
        
**ê¸°ì¡´ êµ¬ì¡°ì—ì„œì˜ ë¬¸ì œ ì¬í˜„**
        
- ì¸ìœ„ì ìœ¼ë¡œ íŠ¸ëœì­ì…˜ ì˜ˆì™¸ ë°œìƒ (e.g. `throw new RuntimeException()`)
- Redis ì…ì°°ê°€ëŠ” ì—…ë°ì´íŠ¸ ë˜ì—ˆìœ¼ë‚˜, DBëŠ” ë°˜ì˜ë˜ì§€ ì•ŠìŒ
- ì´í›„ ì…ì°°ìëŠ” ê³„ì† 409 ì˜¤ë¥˜ (ì…ì°°ê°€ ë‚®ìŒ) ë°œìƒ
        
**ì´ë²¤íŠ¸ êµ¬ì¡° ë„ì… ì´í›„**
        
- íŠ¸ëœì­ì…˜ì´ ì‹¤íŒ¨í•  ê²½ìš° RedisëŠ” ê·¸ëŒ€ë¡œ ìœ ì§€
- íŠ¸ëœì­ì…˜ì´ ì„±ê³µí•œ ê²½ìš°ì—ë§Œ Redis ê°±ì‹ 
- DBì™€ Redis ê°„ì˜ ì •í•©ì„± ìœ ì§€
        
<br>
        
### 6. ë°°ìš´ ì  ë° ì ìš© íš¨ê³¼
        
| í•­ëª© | ê°œì„  ì „ | ê°œì„  í›„ |
| --- | --- | --- |
| Redis ê°’ ë°˜ì˜ ì‹œì  | íŠ¸ëœì­ì…˜ ë„ì¤‘ | íŠ¸ëœì­ì…˜ ì»¤ë°‹ ì´í›„ |
| ë°ì´í„° ë¶ˆì¼ì¹˜ ê°€ëŠ¥ì„± | ë§¤ìš° ë†’ìŒ | ê±°ì˜ ì—†ìŒ |
| ì…ì°° ì˜¤ë¥˜ ë°œìƒë¥  | ë†’ìŒ | ì—†ìŒ |
| êµ¬ì¡° ì•ˆì •ì„± | ì·¨ì•½ | ì•ˆì •ì  |
        
<br>
        
### 7. í–¥í›„ ê°œì„  ì‚¬í•­
        
- **Redis ê°±ì‹  ì‹¤íŒ¨ ëŒ€ì‘**: ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë‚´ë¶€ì—ì„œ Redis ì¥ì•  ì‹œ ì¬ì‹œë„ ì „ëµ í•„ìš”
- **ë¶„ì‚° ë½ ì—°ê³„**: ì…ì°° ê°±ì‹  ì‹œì ì— ë ˆë””ìŠ¤ ë½ì„ í•¨ê»˜ ì ìš©í•´ ê²½ìŸ ì¡°ê±´ í•´ì†Œ
- **ëª¨ë‹ˆí„°ë§ ì¶”ê°€**: ì…ì°° ì‹œ Redis/DB ê°„ ë¶ˆì¼ì¹˜ ê°ì§€ ë¡œê¹… ì¶”ê°€ ì˜ˆì •

</details>
  
<details>
<summary><strong>API Gateway ì—ì„œ Admin ìš”ì²­ë§Œ ë”°ë¡œ ì¸ê°€ ê³¼ì •</strong></summary>
    
### 1. ë¬¸ì œ ìš”ì•½
    
- API Gatewayì—ì„œ ìš”ì²­í•œ í´ë¼ì´ì–¸íŠ¸ì˜ JWTë¥¼ ì¸ì¦ ì„œë²„ì˜ `/api/v1/auth/validate` ë¡œ ë³´ë‚´ëŠ” ì½”ë“œë¥¼ ì‘ì„±í•¨
- í•´ë‹¹ API ì—ì„œ ë°›ì€ í† í°ì˜ ì¸ì¦/ì¸ê°€ë¥¼ í•´ì•¼ ë¨
- admin ìš”ì²­ë§Œ ë”°ë¡œ ì¸ê°€ë¥¼ ì–´ë–»ê²Œ í•´ì•¼ ë ì§€ ê³ ë¯¼
    
<br>
    
### 2. ë¬¸ì œ ë°œìƒ ë°°ê²½
    
ê¸°ì¡´ êµ¬ì¡°ì—ì„œëŠ” API ìš”ì²­ ì‹œ ë‹¤ìŒê³¼ ê°™ì€ íë¦„ìœ¼ë¡œ ì²˜ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤:
    
1. ì‚¬ìš©ìì˜ API ìš”ì²­ ìˆ˜ì‹ 
2. API Gateway â†’ ì¸ì¦ ì„œë²„ì˜ `/api/v1/auth/validate` ë¡œ ì—°ê²°
3. ì¸ì¦ ì„œë²„ì—ì„œ ì¸ì¦/ì¸ê°€ë¥¼ ë§ˆì¹˜ë©´ API Gatewayë¡œ ì¸ì¦ì´ ì™„ë£Œë¨ì„ ì•Œë¦¼
4. API Gatewayì—ì„œ ìš”ì²­ ë°›ì€ APIë¡œ ë¼ìš°íŒ…
    
### ì–´ë–»ê²Œ Admin ìš”ì²­ë§Œ ë”°ë¡œ ì¸ê°€ë¥¼ í•  ìˆ˜ ìˆì„ê¹Œ?
    
- ê°œì„  ì „ `/api/v1/auth/validate` êµ¬ì¡°
    
  ```java
    // Controller
    	@PostMapping("/v1/auth/validate")
    	public ResponseEntity<Void> validateToken(
    		@RequestHeader("Authorization") String authToken
    	) {
    		authService.validateToken(authToken);
    		return ResponseEntity.ok().build();
    	}
    	
    // Service
    	@Transactional
    	public void validateToken(String authToken) {
    		String token = jwtUtil.substringToken(authToken);
    		
    		Claims claims = jwtUtil.extractClaims(token);
    		
    		Long memberId = Long.valueOf(claims.getSubject());
    		String email = claims.get("email", String.class);
    		
    		if (!memberRepository.existsByIdAndEmail(memberId, email)) {
    			throw new ServerException(USER_NOT_FOUND);
    		}
    		String role = claims.get("role", String.class);
    		MemberRole.of(role);
    	}
  ```
    
- ê°œì„  ì „ API Gatewayì˜ `application-local.yml` êµ¬ì¡°
    
  ```yaml
    spring:
      cloud:
        gateway:
          routes:
           ...
  
            - id: module-auth
              uri: http://localhost:8083
              predicates:
                - Path=/api/v*/auth/**
                
           ...
    
            - id: module-point
              uri: http://localhost:8086
              predicates:
                - Path=/api/v*/points/**, /api/v*/pointHistories/**, /api/v*/payments/**, /api/v*/admin/**
              filters:
                - name: ValidateToken
                - RewritePath=/module-point/(?<segment>.*), /${segment}
  ```
    
- ê°œì„  ì „ `ValidateTokenGatewayFilterFactory` êµ¬ì¡°
    
  ```java
    @Component
    public class ValidateTokenGatewayFilterFactory
    	extends AbstractGatewayFilterFactory<ValidateTokenGatewayFilterFactory.Config> {
    	
    	// í•„í„° íŒ©í† ë¦¬ê°€ Config ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë°›ê¸° ìœ„í•´ ì‚¬ìš©
    	public static class Config {}
    	
    	private final WebClient webClient = WebClient.create("http://localhost:8083");
    	
    	public ValidateTokenGatewayFilterFactory() {
    		super(Config.class);
    	}
    	
    	@Override
    	public GatewayFilter apply(Config config) {
    		return (exchange, chain) -> {
    			String authHeader = exchange.getRequest().getHeaders().getFirst(HttpHeaders.AUTHORIZATION);
    			
    			// í—¤ë”ê°€ ì—†ê±°ë‚˜ Bearer ë¡œ ì‹œì‘í•˜ì§€ ì•Šìœ¼ë©´ 401
    			if (authHeader == null || !authHeader.startsWith("Bearer ")) {
    				exchange.getResponse().setStatusCode(HttpStatus.UNAUTHORIZED);
    				return exchange.getResponse().setComplete();
    			}
    			
    			// ì¸ì¦ ì„œë²„ë¡œ í† í° ê²€ì¦ ìš”ì²­
    			return webClient.post()
    				.uri("/api/v1/auth/validate")
    				.header(HttpHeaders.AUTHORIZATION, authHeader)
    				.retrieve()
    				.onStatus(HttpStatusCode::isError,
    					resp -> Mono.error(new ResponseStatusException(resp.statusCode())))
    				.bodyToMono(Void.class)
    				.then(chain.filter(exchange))
    				.onErrorResume(ResponseStatusException.class, ex -> {
    					exchange.getResponse().setStatusCode(ex.getStatusCode());
    					return exchange.getResponse().setComplete();
    				});
    		};
    	}
    }
  ```
    
<br>
    
### 4. ê°œì„  ì „ëµ: Admin API ì˜ idë§Œ ë”°ë¡œ ë¹¼ê¸° + Gatewayì—ì„œ Admin API ì¼ ì‹œ Roleì„ ë³´ë‚´ê¸°.
    
  ### âœ… ê°œì„  í›„ êµ¬ì¡°
    
  - ê°œì„  í›„ `/api/v1/auth/validate` êµ¬ì¡°
    
    ```java
    // Controller
    	@PostMapping("/v1/auth/validate")
    	public ResponseEntity<Void> validateToken(
    		@RequestHeader("Authorization") String authToken,
    		@RequestParam(required = false) String requiredRole
    	) {
    		authService.validateToken(authToken, requiredRole);
    		return ResponseEntity.ok().build();
    	}
    
    // Service
    	@Transactional
    	public void validateToken(String authToken) {
    		String token = jwtUtil.substringToken(authToken);
    		
    		Claims claims = jwtUtil.extractClaims(token);
    		
    		Long memberId = Long.valueOf(claims.getSubject());
    		String email = claims.get("email", String.class);
    		
    		if (!memberRepository.existsByIdAndEmail(memberId, email)) {
    			throw new ServerException(USER_NOT_FOUND);
    		}
    		String role = claims.get("role", String.class);
    		MemberRole.of(role);
    		
    		if (requiredRole != null && !requiredRole.isEmpty() && !requiredRole.equals(role)) {
    			throw new ServerException(USER_ACCESS_DENIED);
    		}
    	}
    ```
    
- ê°œì„  í›„ API Gatewayì˜ `application-local.yml` êµ¬ì¡°
    
    ```yaml
    spring:
      cloud:
        gateway:
          routes:
          ...

            - id: module-auth
              uri: http://localhost:8083
              predicates:
                - Path=/api/v*/auth/**
    
          ...
    
            - id: module-point
              uri: http://localhost:8086
              predicates:
                - Path=/api/v*/points/**, /api/v*/pointHistories/**, /api/v*/payments/**
              filters:
                - name: ValidateToken
                - RewritePath=/module-point/(?<segment>.*), /${segment}
    
            - id: admin-point
              uri: http://localhost:8086
              predicates:
                - Path=/api/v*/admin/**
              filters:
                - name: ValidateToken
                  args:
                    requiredRole: ROLE_ADMIN
                - RewritePath=/admin-point/(?<segment>.*), /${segment}
    ```
    
  - ê°œì„  í›„ `ValidateTokenGatewayFilterFactory` êµ¬ì¡°
    
    ```java
    @Component
    public class ValidateTokenGatewayFilterFactory
    	extends AbstractGatewayFilterFactory<ValidateTokenGatewayFilterFactory.Config> {
    
    	// í•„í„° íŒ©í† ë¦¬ê°€ Config ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë°›ê¸° ìœ„í•´ ì‚¬ìš©
    	@Getter
    	@Setter
    	public static class Config { private String requiredRole; }
    
    	private final WebClient webClient = WebClient.create("http://localhost:8083");
    
    	public ValidateTokenGatewayFilterFactory() {
    		super(Config.class);
    	}
    
    	@Override
    	public GatewayFilter apply(Config config) {
    		return (exchange, chain) -> {
    			String authHeader = exchange.getRequest().getHeaders().getFirst(HttpHeaders.AUTHORIZATION);
    
    			// í—¤ë”ê°€ ì—†ê±°ë‚˜ Bearer ë¡œ ì‹œì‘í•˜ì§€ ì•Šìœ¼ë©´ 401
    			if (authHeader == null || !authHeader.startsWith("Bearer ")) {
    				exchange.getResponse().setStatusCode(HttpStatus.UNAUTHORIZED);
    				return exchange.getResponse().setComplete();
    			}
    
    			// ì¸ì¦ ì„œë²„ë¡œ í† í° ê²€ì¦ ìš”ì²­
    			return webClient.post()
    				.uri(uriBuilder -> uriBuilder
    					.path("/api/v1/auth/validate")
    					.queryParam("requiredRole", config.getRequiredRole())
    					.build())
    				.header(HttpHeaders.AUTHORIZATION, authHeader)
    				.retrieve()
    				.onStatus(HttpStatusCode::isError,
    					resp -> Mono.error(new ResponseStatusException(resp.statusCode())))
    				.bodyToMono(Void.class)
    				.then(chain.filter(exchange))
    				.onErrorResume(ResponseStatusException.class, ex -> {
    					exchange.getResponse().setStatusCode(ex.getStatusCode());
    					return exchange.getResponse().setComplete();
    				});
    		};
    	}
    }
    ```
    
<br>
    
### 5. ì‹¤í–‰ êµ¬ì¡°
    
- ë§Œì•½ Admin APIë¡œ ë“¤ì–´ì˜¬ ê²½ìš° **requiredRole**ì— `ROLE_ADMIN` ì„ ë‹´ì•„ì„œ í•´ë‹¹ APIê°€ Admin API ì„ì„ ì•Œë¦¼
- `/api/v1/auth/validate` ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ë§Œì•½ requiredRoleì´ ë‹´ê²¨ì ¸ ì˜¨ë‹¤ë©´ ì„œë¹„ìŠ¤ì—ì„œ í•´ë‹¹ JWT ì˜ Roleì´ `ROLE_ADMIN` ì¸ì§€ ê²€ì‚¬
    
<br>
    
### 6. í–¥í›„ ê°œì„  ì‚¬í•­
    
- ì´ë ‡ê²Œ Gatewayì—ì„œ ì§ì ‘ Roleë¡œ ë„˜ê²¨ì£¼ëŠ”ê±´ ë³„ë¡œì¸ ê²ƒ ê°™ë‹¤.
- `Security Config` ì—ì„œ ì§ì ‘ ì¸ê°€ë¥¼ í•˜ë„ë¡ í•´ì•¼ í•  ê²ƒ ê°™ë‹¤.

</details>

<details>
<summary><strong>Path Validation Error ë¬¸ì œ</strong></summary>

### 1. ë¬¸ì œ ìš”ì•½
    
- ci.yml ì‘ì„± ì¤‘ `Gradle dependencies caching` ì¤‘ actions/cache@v4ì—ì„œ ì§€ì •í•œ ìºì‹œ ê²½ë¡œê°€ ì›Œí¬í”Œë¡œìš° ì‹¤í–‰ ì¤‘ì— ì¡´ì¬í•˜ì§€ ì•Šì•„ì„œ ìºì‹œê°€ ì €ì¥ë˜ì§€ ì•Šì•˜ë‹¤.
- ë¹Œë“œ ìì²´ì—ëŠ” ì˜í–¥ì„ ì£¼ì§€ ì•Šì•˜ì§€ë§Œ, ìºì‹œê°€ ì €ì¥ë˜ì§€ ì•Šì•„ ë‹¤ìŒ ì›Œí¬í”Œë¡œìš° ì‹¤í–‰ ì‹œ ìºì‹œë¥¼ ì¬ì‚¬ìš©í•  ìˆ˜ ì—†ì–´ì„œ ë¹Œë“œ ì‹œê°„ì´ ëŠ˜ì–´ë‚  ìˆ˜ ìˆë‹¤.
- .í•´ê²° ì±… ì¤‘ /gradlew --version , ./gradlew projects ì¤‘ ì–´ëŠ ê²ƒì„ ì‚¬ìš©í• ì§€ ê³ ë¯¼í•˜ì˜€ë‹¤.

<br>
    
### 2. ë¬¸ì œ ë°œìƒ ë°°ê²½
    
ì¼ë¶€ ëª¨ë“ˆë§Œ ë¹Œë“œ ë˜ë©´ Gradleì´ ëª¨ë“  ìºì‹œ ë””ë ‰í† ë¦¬(~/.gradle/caches, ~/.gradle/wrapper)ë¥¼ ì™„ì „íˆ ì´ˆê¸°í™”í•˜ê±°ë‚˜ ì±„ìš°ì§€ ì•Šì„ ìˆ˜ ìˆë‹¤. 
    
íŠ¹íˆ ./gradlew --version ê°™ì€ ì´ˆê¸°í™” ëª…ë ¹ì´ ì—†ì—ˆê¸° ë•Œë¬¸ì—, ì›Œí¬í”Œë¡œìš° ì´ˆê¸°ì— ìºì‹œ ë””ë ‰í† ë¦¬ê°€ ìƒì„±ë˜ì§€ ì•Šì•˜ì„ ê°€ëŠ¥ì„±ì´ í¬ë‹¤.
    
actions/cache@v4ê°€ ì›Œí¬í”Œë¡œìš° ëì—ì„œ ~/.gradle/cachesë‚˜ ~/.gradle/wrapperë¥¼ ì €ì¥í•˜ë ¤ í–ˆì§€ë§Œ, ë””ë ‰í† ë¦¬ê°€ ë¹„ì–´ ìˆê±°ë‚˜ ì¡´ì¬í•˜ì§€ ì•Šì•„ ê²½ê³ ê°€ ë°œìƒí•˜ëŠ” ê²ƒì´ë‹¤.
    
### ì–´ë–»ê²Œ í•´ê²°í•  ìˆ˜ ìˆì„ê¹Œ?
    
- ./gradlew --version
- ./gradlew projects
    
ë‘˜ ì¤‘ í•˜ë‚˜ë¥¼ ì„ íƒí•˜ì—¬ í•´ê²°í•  ìˆ˜ ìˆë‹¤.
    
ë‚˜ëŠ” ./gradlew --version ëŒ€ì‹  ./gradlew projectsì„ ì‚¬ìš©í•˜ì˜€ë‹¤.
    
./gradlew projects ëª…ë ¹ì€ Gradle í”„ë¡œì íŠ¸ì˜ êµ¬ì¡°ë¥¼ ì¶œë ¥í•˜ëŠ” ëª…ë ¹ìœ¼ë¡œ, í”„ë¡œì íŠ¸ì™€ í•˜ìœ„ í”„ë¡œì íŠ¸(ëª¨ë“ˆ) ëª©ë¡ì„ í‘œì‹œí•œë‹¤. ì´ ëª…ë ¹ì„ ì›Œí¬í”Œë¡œìš°ì— ì¶”ê°€í•œ ëª©ì ì€ ~/.gradle/cachesì™€ ~/.gradle/wrapper ë””ë ‰í† ë¦¬ë¥¼ ìƒì„±í•´ì„œ actions/cache@v4ê°€ ìºì‹œë¥¼ ì €ì¥í•  ìˆ˜ ìˆë„ë¡ ë³´ì¥í•˜ì˜€ë‹¤.
    
ì´ ë””ë ‰í† ë¦¬ê°€ ìˆìœ¼ë©´ ì›Œí¬í”Œë¡œìš° ëì—ì„œ actions/cache@v4ê°€ ì´ë“¤ì„ ìºì‹œë¡œ ì €ì¥í•  ìˆ˜ ìˆì–´, Path Validation Error ê²½ê³ ë¥¼ ë°©ì§€í•œë‹¤.
    
<br>
    
### â­• ê³µí†µì 
    
ë‘˜ ë‹¤ Gradleì„ ì´ˆê¸°í™”í•´ì„œ ~/.gradle/cachesì™€ ~/.gradle/wrapper ë””ë ‰í† ë¦¬ë¥¼ ìƒì„±.Path Validation Error ê²½ê³ ë¥¼ í•´ê²°í•˜ëŠ” ë° ì‚¬ìš© ê°€ëŠ¥í•˜ë‹¤.
    
### âŒ ì°¨ì´ì 
    
- ./gradlew --version:
  - **ì‘ì—…**: Gradle ë²„ì „ ì •ë³´ ì¶œë ¥.
  - **ì†ë„**: ë§¤ìš° ë¹ ë¦„ (1~2ì´ˆ).
  - **ë¶€í•˜**: ìµœì†Œí•œì˜ ì‘ì—…, í”„ë¡œì íŠ¸ ì„¤ì •ì„ ì½ì§€ ì•ŠìŒ.
    
- ./gradlew projects:
  - **ì‘ì—…**: í”„ë¡œì íŠ¸ êµ¬ì¡° ë¶„ì„ ë° ì¶œë ¥.
  - **ì†ë„**: ì•½ê°„ ëŠë¦¼ (2~3ì´ˆ, í”„ë¡œì íŠ¸ í¬ê¸°ì— ë”°ë¼ ë‹¤ë¦„).
  - **ë¶€í•˜**: build.gradle, settings.gradleì„ íŒŒì‹±í•˜ë¯€ë¡œ ì•½ê°„ ë” ë¬´ê±°ì›€.
    
./gradlew projectsëŠ” í”„ë¡œì íŠ¸ êµ¬ì¡°ë¥¼ í™•ì¸í•˜ëŠ” ë¶€ê°€ íš¨ê³¼ê°€ ìˆê³  í”„ë¡œì íŠ¸ êµ¬ì¡° ì´ˆê¸°í™”ë¥¼ í•´ì£¼ì–´ ì ì¬ì ì¸ ìºì‹œ ë¬¸ì œë¥¼ ì˜ˆë°©í•œë‹¤.

</details>
